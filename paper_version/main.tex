\documentclass{article}
\usepackage[utf8]{inputenc}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{bm}
\usepackage{hyperref}
\usepackage{geometry}
\geometry{a4paper,scale=0.8}
\usepackage[square,numbers]{natbib}
\bibliographystyle{abbrvnat}
\usepackage{tikz}
\usepackage{tkz-euclide}
\usetikzlibrary{positioning, decorations.markings, arrows, intersections}
\usepackage{nicematrix}
\NiceMatrixOptions{cell-space-top-limit = 4pt}
\NiceMatrixOptions{cell-space-bottom-limit = 4pt}
\usepackage{tcolorbox}
\usepackage{caption, subcaption}
\captionsetup[figure]{labelfont={bf},name={Fig.},labelsep=period}
\captionsetup[table]{labelfont={bf},name={Tab.},labelsep=period}
\usepackage{authblk}
\usepackage{soul}

\newtheorem*{remark}{Remark}
\DeclareMathOperator*{\argmin}{arg\,min}

\newcommand{\mycolorbox}[2]{\colorbox{#1}{$\displaystyle#2$}}
\newcommand{\todo}[1]{\textcolor{blue}{\fbox{\textbf{TODO: #1}}}}
\newcommand{\todobox}[1]{
    \begin{tcolorbox}[title=TODO list, colback=blue!10, colframe=blue]
        #1
    \end{tcolorbox}
}


\title{APPM report - Draft}
\author[1]{R. Hiptmair}
\author[1]{T.W. Yu}
\author[2]{R. Fuchs}
\affil[1]{Seminar for Applied Mathematics , ETH Z\"{u}rich}
\affil[2]{IET Institut fÃ¼r Energietechnik, OST}
\date{}

\begin{document}
\maketitle

\section*{Abstract}
A key coefficient characterizing plasmas is the so-called Debye length $\lambda_D$, whose size indicates to what extent electric charges can deviate from the neutral case: If $\lambda_D = \mathcal{O}(1)$ we face the non-neutral regime, while for $\lambda_D\to 0$ the plasma becomes quasi-neutral. Plasma models have rather different properties in these two regimes due to the singular perturbation arising from the $\lambda_D\to 0$ limit.
Since both regimes may coexist in some plasma phenomena, it is desired to design numerical schemes that are \emph{robust} for arbitrary $\lambda_D$. More precisely, they should be \emph{asymptotic-preserving} (AP), in the sense that the limit $\lambda_D\to 0$ of the scheme yields a viable discretization for the continuous limit model.

An asymptotic-preserving scheme for single- and multi-fluid Euler-Maxwell system was proposed by \cite{degond_2012} for one spatial dimension. We extend their scheme to three dimensions. The key ingredients are (i) a discretization of Maxwell's equations based on primal and dual meshes in the spirit of discrete exterior calculus (DEC)/the finite integration technique (FIT), (ii) finite volume method (FVM) for the fluid equations on the dual mesh, and (iii) mixed implicit-explicit timestepping. The scheme is designed to be AP as $\lambda_D \rightarrow 0$ and this is validated through numerical experiments. Special care is necessary for the boundary conditions which must be valid in both regimes. Additionally, if the electromagnetic fields have to be modelled in an insulating region beyond the plasma domain, additional stabilization to accommodate Gauss's law is necessary.

\section{Introduction}
We consider a hydrodynamic multi-species plasma model, which boils down to the Maxwell-Euler system. As in \cite{degond_2012}, our focus is an \emph{asymptotic-preserving} (AP) discretization in the quasi-neutral limit $\lambda_D \rightarrow 0$, where $\lambda_D$ is the rescaled Debye length, see Section \ref{sec:rescaling} for the underlying scaling arguments and \cite{degond_2012,degond_2017} for a discussion of the importance of the AP property in plasma codes.  

Our approach is inspired by \cite{degond_2012}, but goes beyond that work in various directions:
\begin{itemize}
    \item we supplement the Maxwell-Euler system by inter-species friction;
    \item we extend the spatially 1D scheme of \cite{degond_2012} to three spatial dimensions using discrete exterior calculus (DEC) for Maxwell's equations combined with a low-order finite volume method for Euler's equations;
    \item we propose an essential stabilization in non-conducting regions;
    \item we introduce suitable boundary conditions for the electromagnetic fields at a spatial truncation boundary.
\end{itemize}

We stay close to \cite{degond_2012} in terms of discretization in time by semi-implicit time-stepping and by restricting to a cylindrical geometry shown in Fig. \ref{fig:domain_geometry}. We would like to remark that the mesh-based numerical scheme proposed in this paper can in principle be adapted to geometric situations much more general than that of Fig. \ref{fig:domain_geometry}. However, one may encounter subtle problems in defining proper mesh duality as we need it in Section \ref{sec:mesh-duality}. Thus, for the sake of simplicity of presentation we forgo geometric generality.

The quasi-neutral limit of the Maxwell system leads to a singularly perturbed problem in the sense that the system changes its type from hyperbolic to a mixture of hyperbolic, parabolic and elliptic, which poses a challenge for simulations in setting that encompass different regimes. Such situations occur in many physical models, e.g. vanishing viscosity in the Navier-Stokes equations\cite{Kato_1984}, zero-relaxation-limit of kinetic equations\cite{jin_2010} and zero-Mach-limit of compressible flows\cite{degond_2007, haack_2010}. It is desirable that numerical schemes are valid for all ranges of scaled parameters. These schemes are then said to be \emph{asymptotic-preserving} (AP). The concept is sketched by the commutative diagram in \cite{jin_1999}. We discrete a parametric problem $P^\lambda$, which converges to its limit $P^0$ as the perturbed parameter $\lambda \rightarrow 0$ by the scheme $P^\lambda_h$ where $h$ denotes some discretization parameter, e.g. mesh size. The AP property requires the uniform convergence of $P^\lambda_h$ to the $P^\lambda$ as $\lambda\rightarrow0$. For more details about AP schemes, see \cite{jin_2010, degond_2017} for comprehensive reviews.

The content of this paper is organized as follows. In Section 2, we give a full description of the underlying equations of the Maxwell-Euler system and its rescaling procedure. Meanwhile, the boundary conditions in our setting is elaborated. A reformulation of Maxwell's equations in the insulating region is then presented. Section 3 is devoted to the spatial discretizatio. The concept of primal-dual meshes is introduced based on which FIT and FVM are applied. We discuss the fully-discretized AP scheme in Section 4 and do numerical experiments in Section 5.  

\begin{figure}
    \centering
    \begin{tikzpicture}
    \coordinate (O1) at (0,0);
    \draw[violet] (O1) circle (1) node[blue] {Electrode};
    \fill[blue, opacity=0.2] (O1) circle (1);
    \draw[very thick] (O1) circle (1.5);
    \coordinate (O2) at (4.5,1);
    \draw[violet] (O2) circle (1);
    \node at (O2) {\textcolor{red}{Electrode}};
    \node at (barycentric cs:O1=1,O2=1) {Plasma}; 
    \fill[red, opacity=0.2] (O2) circle (1);
    \coordinate (S1) at ([shift={(-0.196,0.98)}]O1);
    \coordinate (S2) at ([shift={(-0.196,0.98)}]O2);
    \coordinate (P1) at ([shift={(0.196,-0.98)}]O1);
    \coordinate (P2) at ([shift={(0.196,-0.98)}]O2);
    \draw[violet] (S1) -- (S2);
    \draw[violet] (P1) -- (P2);
    \coordinate (SS1) at ([shift={({-0.196*1.5},{0.98*1.5})}]O1);
    \coordinate (SS2) at ([shift={({-0.196*1.5},{0.98*1.5})}]O2);
    \coordinate (PP1) at ([shift={({0.196*1.5},{-0.98*1.5})}]O1);
    \coordinate (PP2) at ([shift={({0.196*1.5},{-0.98*1.5})}]O2);
    \draw[very thick] (SS1) -- (SS2);
    \draw[very thick] (PP1) -- (PP2); 
    \draw[black, very thick] (SS2) arc (101.31:180+101.31:1.5);
    \draw[very thick] (PP2) arc (101.31-180:101.31:1.5);
    \draw[-to] (barycentric cs:SS1=1,SS2=1,S1=1,S2=1) to[out=90,in=0] ([shift={(-0.5,0.5)}]barycentric cs:SS1=1,SS2=1,S1=1,S2=1) node[left, gray] {Insulator};
    \begin{scope}[shift={(5.5,-1.4)}]
    \draw[blue, -to] (0,0) -- (0.65,0.12) node[right]{\small $z$};
    \draw[blue, -to] (0,0) -- (0,0.7) node[above]{\small $x$};
    \draw[blue, -to] (0,0) -- (0.7,0) node[below]{\small $y$};
    \end{scope}
    \end{tikzpicture}
\caption{The domain geometry}
\label{fig:domain_geometry}
\end{figure}



\section{Plasma model}
\begin{comment}
Under moderate assumptions, plasmas, which are gases composed of charged particles (and possibly neutral particles), can be treated as fluid and described by hydrodynamic equations. Maxwell's equations are involved to describe their induction of and interaction with electromagnetic fields. 

After rescalling all the variables with respect to the prescribed reference units, the Debye length $\lambda_D$, characterizing the charge screening ability of the plasma, would pop up and its zero limit, which is what we called \emph{quasi-neutral limit}, is of great interest, since the limit model largely simplifies the system and in many cases the accuracy of the assumption is satisfactory enough. 

In this section, the multi-species Maxwell-Euler equations with collision term is introduced first, followed by detailed rescalling procedure. The quasi-neutral model will be make clear by letting the rescaled Debye length $\lambda$ go to zero. Afterwards, a set of boundary conditions are presented and its validity to both non-limit and limit model is discussed. Finally, we would like to present a reformulation of the system which would be crucial to the stability of the numerical scheme.
\end{comment}

\begin{comment}
In this work, we discuss and implement the so-called \emph{Euler-Maxwell} system with a focus on its limiting behavior of quasi-neutrality, i.e. when the \emph{Debye length} goes to zero. The dimensionless form of the Euler-Maxwell equations is parameterized by the rescaled Debye length $\lambda$ whose vanishing limit alters the mathematical nature of the equations. To be more concrete, the non-limit model ($\lambda = \mathcal{O}(1)$) is hyperbolic where information spreads with a finite speed whereas the limit model ($\lambda \rightarrow 0$) becomes elliptic, and any changes immediately influence the whole domain. In other words, the perturbation of $\lambda$ in the Maxwell-Euler system poses a singular perturbation problem. Such switching makes it difficult to handle both models in a single implementation framework, which, however, is desired in many cases where both models coexist in the computational domain. Now comes the concept of \emph{asymptotic-preserving}(AP) scheme. We turn to the celebrated commuting diagram Fig. \ref{fig:commuting_diagram_ap} for illustration.\todo{add illustration of AP schemes}.

The other emphasis of this work is the development of a 3D discretization framework for the Maxwell-Euler system. The key ingredient is the combination of the finite volume Method (FVM) for the Euler equations and the Finite Integration Technique (FIT) for Maxwell's equations. The latter one is usually treated as a generalization to Yee's scheme \citep{yee_1966} or FDTD. The advantage of the FVM-FIT framework lie in the \emph{discrete exterior calculus} (DEC) nature of FIT and straightforward coupling of both systems through the primal-dual mesh pair. These would be made clear in the corresponding sections. 

\todo{add previous work on AP schemes, FIT, plasma simulation}.

The content of this paper is organized as follows. In Section 2 we introduce the full Maxwell-Euler model for plasmas, followed by the rescaling procedure which is crucial to define the rescaled Debye length $\lambda$ and to identify its limiting behavior. In the meantime, it is essential to discuss what boundary conditions are appropriate for this singular perturbation problem. Section 3 is then dedicated to a brief introduction about \cite{degond_2012} based on which our work is extended. In Section 4, we first discuss our FVM-FIT framework in details, especially how the unknowns are assigned on the staggered meshes and the boundary treatment in 3D case. Afterwards, the full discretization scheme is presented. Special care shall be taken to the treatment of boundary conditions and insulator part of the domain as $\lambda \rightarrow 0$, which is crucial to make the scheme AP. A numerical experiment for a 3D cylindrical domain is presented in Section 5 where we want to demonstrate the capability of our scheme in dealing with both non-neutral and quasi-neutral regimes of plasmas.    

\begin{figure}
    \centering
    \begin{tikzpicture}
    \node (nw) {\Large $P^\lambda_h$};
    \node (ne) [right=3cm of nw]{\Large $P^\lambda$};
    \node (sw) [below=of nw]{\Large $P^0_h$};
    \node (se) [right=3cm of sw]{\Large $P^0$};
    \draw[->] (nw.east)  -- node [above,midway] {$h\rightarrow0$} (ne.west) ;
    \draw[->] (nw.east)  --  (ne.west) ;
    \draw[->] (nw.south) -- node [left,midway] {$\lambda\rightarrow0$} (sw.north);
    \draw[->] (nw.south) -- node {} (sw.north);
    \draw[->] (sw.east)  -- node [above,midway] {$h\rightarrow0$}(se.west);
    \draw[->] (ne.south) -- node [left,midway] {$\lambda\rightarrow0$} (se.north);
    \end{tikzpicture}
    \caption{Commuting diagram of AP schemes}
    \label{fig:commuting_diagram_ap}
\end{figure}
\end{comment}

\subsection{The Maxwell-Euler System}
Under moderate assumptions, plasmas, which are gases composed of charged particles (and possibly neutral particles), can be treated as fluids governed by hydrodynamic equations. Maxwell's equations describe their interaction with electromagnetic fields. For more details on the fluid model of plasma, see \cite{chen2016, remi_2014}.

The Maxwell's equations in SI units read
\begin{subequations}
\begin{align}
    \partial_t \mathbf{B} + \nabla \times \mathbf{E} &= 0, \label{equ:maxwell_faraday} \\ 
    \partial_t \mathbf{D} - \nabla \times \mathbf{H} &= -\mathbf{J}, \label{equ:maxwell_ampere} \\
    \nabla \cdot \mathbf{B} &= 0,  \label{equ:maxwell_gauss_B}\\
    \nabla \cdot \mathbf{D} &= \rho, \label{equ:maxwell_gauss_D}
\end{align}
\end{subequations}
where the involved quantities are magnetic flux density $\mathbf{B}[\frac{\text{Wb}}{\text{m}^2}]$, electric field intensity $\mathbf{E}[\frac{\text{V}}{\text{m}}]$, electric induction $\mathbf{D}[\frac{\text{C}}{\text{m}^2}]$, magnetic field intensity $\mathbf{H}[\frac{\text{A}}{\text{m}}]$, electric current density $\mathbf{J}[\frac{\text{A}}{\text{m}^2}]$ and electric charge density $\rho[\frac{\text{C}}{\text{m}^3}]$. These equations are known as Faraday's law (\ref{equ:maxwell_faraday}), Amp\`{e}re's law (\ref{equ:maxwell_ampere}), Gauss's law for magnetism (\ref{equ:maxwell_gauss_B}) and Gauss's law for electric field (\ref{equ:maxwell_gauss_D}). For simplicity, we only consider isotropic and homogeneous media in vacuum. We consider the linear constitutive relations 
\begin{equation} \label{equ:material_law}
    \mathbf{D} = \varepsilon_0 \mathbf{E}, \ \ \ \mathbf{B} = \mu_0\mathbf{H}, 
\end{equation}
where $\varepsilon_0]$ and $\mu_0$ are the vacuum permittivity and permeability of the medium. The electric current density $\mathbf{J}$ and electric charge density $\rho$ are supposed to satisfy the charge conservation equation
\begin{equation} \label{equ:charge_continuity}
    \partial_t\rho + \nabla \cdot \mathbf{J} = 0.
\end{equation}
Besides, on taking the divergence of equations (\ref{equ:maxwell_faraday}) and (\ref{equ:maxwell_ampere}) together with the relation (\ref{equ:charge_continuity}), it is possible to verify that Gauss's laws (\ref{equ:maxwell_gauss_B}) (\ref{equ:maxwell_gauss_D}) are consequences of (\ref{equ:maxwell_faraday}) and (\ref{equ:maxwell_ampere}) provided that (\ref{equ:maxwell_gauss_B}) (\ref{equ:maxwell_gauss_D}) are satisfied at initial time. In other words, Gauss's laws (\ref{equ:maxwell_gauss_B}) (\ref{equ:maxwell_gauss_D}) can be thought of as initial conditions. 

Each species in a plasma can be modelled as a compressible fluid by a set of the Euler equations, which additionally includes electromagnetic forces as well as other processes, e.g. collisions and recombination. The generic expressions are
\begin{align} \label{equ:euler_}
    \partial_t
    \begin{pmatrix}
    n_* \\
    m_*n_* \mathbf{u}_* \\
    m_*n_* e_*
    \end{pmatrix}
    + \nabla \cdot
    \begin{pmatrix}
    n_* \mathbf{u}_* \\
    m_*n_* \mathbf{u}_* \otimes \mathbf{u}_* + p_*\mathbb{I} \\
    m_*n_* h_* \mathbf{u}_*
    \end{pmatrix}
    =
    \begin{pmatrix}
    0 \\
    q_*n_*(\mathbf{E} + \mathbf{u}_* \times \mathbf{B}) \\
    \mathbf{J}_* \cdot \mathbf{E}
    \end{pmatrix}
    +
    \begin{pmatrix}
    \Gamma_* \\
    \mathbf{R}_* \\
    Q_*
    \end{pmatrix}.
\end{align}
The subscript $*\in \{\text{electron}, \text{ion}, \cdots\}$ represents the indices for different species. The involved fluid quantities are: number density $n_*[\frac{1}{\text{m}^3}]$, particle mass $m_*[\text{kg}]$,  charge number $q_*[\text{C}]$, velocity $\mathbf{u}_*[\frac{\text{m}}{\text{s}}]$, pressure $p_*[\frac{\text{N}}{\text{m}^2}]$, specific total energy $e_* := \frac{1}{2}|\mathbf{u}_*|^2 + \frac{p_*}{m_*n_*(\gamma - 1)}[\frac{\text{J}}{\text{kg}}]$, specific total enthalpy $h_* := e_* + \frac{p_*}{m_*n_*}[\frac{\text{J}}{\text{kg}}]$ and current density $\mathbf{J}_* := q_*n_*\mathbf{u}_*[\frac{\text{A}}{\text{m}^2}]$. All the species are assumed to be ideal gases with heat capacity ratio $\gamma=5/3$ for monatomic gases. The left-hand side of the equations describes the convection of plasma fluids. The first term at the right-hand side takes into account the Lorentz force in the momentum equation and Joule heating in the energy equation. $\Gamma_*, \mathbf{R}_*, Q_*$ are generic terms due to effects of inter-species collision, ionization, recombination, etc. 

For the sake of simplicity, we only consider ion-electron collision in this work, but extension to more species is straightforward. Under moderate assumptions, such collisions can be well modelled by friction terms (\citep[][sec. 5.6.2]{chen2016})
\begin{equation} \label{equ:collision}
    \mathbf{R}_{e}^{\text{coll}} = \frac{\pi Ze^4m_e^{1/2}}{(4\pi\varepsilon_0)^2(k_BT_e)^{3/2}}\text{ln}\Lambda n_en_i(\mathbf{u}_i - \mathbf{u}_e) = - \mathbf{R}_{i}^{\text{coll}},  
\end{equation}
which models the collision force that is acting on the electrons. ln$\Lambda$ is called the \emph{Coulomb logarithm}, which typically takes a value $10\sim20$ \cite{chen2016}. Because of the conservation of momentum, the collision term for ions $\mathbf{R}_{i}^{\text{coll}}$ is nothing but the negative of $\mathbf{R}_{e}^{\text{coll}}$. In this work, the other effects, e.g. ionization and recombination, are not considered. For full details about the modeling of these physical processes, readers are referred to \cite{fuchs_2021}.  


Combination of the two sets of equations (\ref{equ:maxwell_faraday}) to (\ref{equ:maxwell_gauss_D}) and (\ref{equ:euler_}) leads to the governing equations for a multi-species plasma model. The coupling of the two subsystems is due to the following relations that connect the fluid and electromagnetic quantities
\begin{equation} \label{equ:maxwell_euler_coupling}
    \rho = \sum_* q_*n_*, \ \ \  \mathbf{J} = \sum_* q_*n_*\mathbf{u}_*. 
\end{equation}

\subsection{Rescaling} \label{sec:rescaling}
In rescaling, variables in equations are replaced the ratio of original quantities and constant reference quantities, which transforms the system into dimensionless form. In this part, the rescaling procedure mostly follows that of \cite{degond_2017}.

First, a reference value for each quantity, e.g. the characteristic length and time scale, is prescribed. We define $\overline{x}$ and $\overline{t}$ as space and time scale of interest, by which the reference velocity $\overline{v}$ is defined as $\overline{x}/\overline{t}$. The typical magnitudes of electromagnetic fields are $\overline{E}$ and $\overline{B}$. The typical magnitudes of fluid quantities are denoted by $\overline{u}$ for plasma drift velocity, $\overline{n}$ for plasma number density, $\overline{T}$ for plasma temperature. On top of that, the typical pressure is set $\overline{n}k_B\overline{T}$ with $k_B$ being the Boltzmann constant; the typical value for the specific total energy and enthalpy is set $\overline{u}^2$. Together with the physical parameters, i.e. permittivity $\varepsilon_0$, permeability $\mu_0$, light speed $c^2 = (\varepsilon_0\mu_0)^{-1}$, Boltzmann constant $k_B$, the elementary charge $e$, and ion mass $m_i$, the following dimensionless parameters are induced,
\begin{align*} 
    \xi &:= \frac{\overline{v}}{c} \text{ the velocity of interest \emph{w.r.t.}\footnotemark[1] the light speed}, &\\
    \zeta &:= \frac{\overline{u}}{\overline{v}} \text{ the plasma velocity \emph{w.r.t.} the speed of interest}, &\\
    M &:= \frac{\overline{u}}{v_{th,i}} \text{ the plasma drift velocity \emph{w.r.t.} the thermal speed of ions, where } v_{th,i} := \left(\frac{k_B \overline{T}}{m_i}\right)^{1/2}, &\\
    \eta &:= \frac{e\overline{E}\overline{x}}{m_i\overline{u}^2} \text{ the electric energy \emph{w.r.t.} the kinetic energy of ions}, &\\
    \beta &:= \frac{\overline{v}\overline{B}}{\overline{E}} \text{ the induced electric field \emph{w.r.t.} the total electric field}, &\\
    \lambda &:= \frac{\lambda_D}{\overline{x}} \text{ the dimensionless Debye length, where }\lambda_D := \left(\frac{\varepsilon_0k_B\overline{T}}{e^2\overline{n}}\right)^{1/2}, &\\
    \varepsilon_*^2 &:= \frac{m_*}{m_i} \text{ the species mass \emph{w.r.t.} the ion mass},\ \  * \in \{\text{ion},\text{electron},\text{neutron},\cdots\}, &\\
    g &:= \frac{1}{\overline{n}\lambda_D^3} \text{ the plasma parameter\footnotemark[2]}.&
\end{align*}
\footnotetext[1]{Abbreviation of \emph{with respect to}.}
\footnotetext[2]{It is basically the reciprocal of the number of particles per Debye sphere, see \cite[][sec. 1.1]{gibbon2020}. Classical plasma theory assumes $g \ll 1$.} 

By abuse of notation, the dimensionless quantities have the same symbol as the original quantities. For the sake of simplicity, we only consider the collision terms, i.e. $\Gamma_* = 0, \mathbf{R}_* = \mathbf{R}_*^\text{coll}, Q_* = Q_*^\text{coll}$ in (\ref{equ:euler_}), while neglecting other effects. The rescaled Euler-Maxwell system reads
\begin{subequations}
\begin{align}
    \beta \partial_t \mathbf{B} + \nabla \times \mathbf{E} &= 0, \label{equ:maxwell_faraday_rescalling} \\ 
    \lambda^2 \partial_t \mathbf{D} - \frac{\beta \lambda^2}{\xi^2}\nabla \times \mathbf{H} &= - \frac{\zeta}{\eta M^2}\mathbf{J}, \label{equ:maxwell_ampere_rescalling} \\
    \nabla \cdot \mathbf{B} &= 0,  \label{equ:maxwell_gauss_B_rescalling}\\
    \lambda^2 \eta M^2 \nabla \cdot \mathbf{D} &= \rho, \label{equ:maxwell_gauss_D_rescalling} \\
    \partial_t
    \begin{pmatrix}
    n_* \\
    n_* \mathbf{u}_* \\
    n_* e_*
    \end{pmatrix}
    + \nabla \cdot
    \begin{pmatrix}
    \zeta n_* \mathbf{u}_* \\
    \zeta n_* \mathbf{u}_* \otimes \mathbf{u}_* + \zeta M^{-2} \varepsilon_*^{-2} p_*\mathbb{I} \\
    \zeta n_* h_* \mathbf{u}_*
    \end{pmatrix}
    &=
    \begin{pmatrix}
    0 \\
    \eta \zeta \varepsilon_*^{-2} q_* n_*\mathbf{E} + \eta \zeta^2 \beta \varepsilon_*^{-2} q_* n_* \mathbf{u}_* \times \mathbf{B} \\
    \zeta \eta \varepsilon_*^{-2} \mathbf{J}_* \cdot \mathbf{E}
    \end{pmatrix} +
    \begin{pmatrix}
    0 \\
    \varepsilon_*^{-2}\mathbf{R}_*^{\text{coll}} \\
    \varepsilon_*^{-2}Q_*^{\text{coll}} \\
    \end{pmatrix}, \label{equ:euler_rescalling}
\end{align}
\end{subequations}
where the equation of state becomes $e_* = \frac{1}{2}|\mathbf{u_*}|^2 + M^{-2}\frac{p_*}{\epsilon^2_* n_* (\gamma - 1)}$ and $h_* = e_* + M^{-2}\frac{p_*}{\epsilon^2_* n_*}$. For a fully-ionized gas, we have the original expression of $\mathbf{R}_*^{\text{coll}}$ in (\ref{equ:collision}), and its rescaled expression becomes
\begin{equation}
    \mathbf{R}_i^{\text{coll}} = \frac{Z\text{ln}\Lambda}{16\pi}g\lambda^{-1}M^{-1}\varepsilon_en_en_i(\mathbf{u}_i - \mathbf{u}_e). \label{equ:rescaling_friction}
\end{equation}

 Assumptions can be made to reduce the number of dimensionless parameters. Following \cite{degond_2017}, the reference speed $\overline{v}$ is of the same scale as the plasma speed $\overline{u}$ and the thermal speed $v_{th,i}$ whereas it is much smaller than the light speed $c$. Also, it is assumed that $\eta$ and $\beta$ are of order one and $\xi$ has the same magnitude as $\lambda$. 

Special treatment is needed for the collision term. One could argue that the occurrence of $\lambda^{-1}$ in (\ref{equ:rescaling_friction}) could lead to singular perturbation of the Euler system as $\lambda \rightarrow 0$. However, the validity of such a collision model is doubtful when $\lambda \rightarrow 0$. From the physical viewpoint, the shielding effect characterized by the rescaled Debye length $\lambda$ makes the impact parameter no larger than $\lambda$. The $\lambda \rightarrow 0$ limit implies that the collisions happen in the atomic length scale, in which quantum-mechanical effects must be taken into effect \citep{frank_1972}. Therefore, for the sake of simplicity, we eliminate the perturbation parameter in the friction term by assuming $g \sim \lambda$ and keep the prefactor of collision term constant $\alpha^{\text{coll}}$ throughout the simulation.

\begin{remark}
    It is also of research interest when there is an asymptotic parameter at the denominator of the friction term. Such problem is called relaxation limit, see \cite{peng_2011, wasiolek_2016, Li_2021, Chen_2000}.
\end{remark}

In summary, we make the following choices
\begin{align*}
    \xi \sim g \sim \lambda \in [0,1], \ \ \ \zeta \sim M \sim \eta \sim \beta \sim \mathcal{O}(1).
\end{align*}


Under such assumptions on these dimensionless parameters, the rescaled Euler-Maxwell system is simplified into a parametric system with the dimensionless Debye length $\lambda$ being the asymptotic parameter
\begin{subequations}
\begin{align}
    \partial_t \mathbf{B} + \nabla \times \mathbf{E} &= 0, \label{equ:maxwell_faraday_rescaled} \\ 
    \lambda^2 \partial_t \mathbf{D} - \nabla \times \mathbf{H} &= - \mathbf{J}, \label{equ:maxwell_ampere_rescaled} \\
    \nabla \cdot \mathbf{B} &= 0,  \label{equ:maxwell_gauss_B_rescaled}\\
    \lambda^2 \nabla \cdot \mathbf{D} &= \rho, \label{equ:maxwell_gauss_D_rescaled} \\
    \partial_t
    \begin{pmatrix}
    n_* \\
    n_* \mathbf{u}_* \\
    n_* e_*
    \end{pmatrix}
    + \nabla \cdot
    \begin{pmatrix}
    n_* \mathbf{u}_* \\
    n_* \mathbf{u}_* \otimes \mathbf{u}_* + \varepsilon_*^{-2} p_*\mathbb{I} \\
    n_* h_* \mathbf{u}_*
    \end{pmatrix}
    &=
    \begin{pmatrix}
    0 \\
    \varepsilon_*^{-2} q_* n_* (\mathbf{E} + \mathbf{u}_* \times \mathbf{B}) \\
    \varepsilon_*^{-2} \mathbf{J}_* \cdot \mathbf{E}
    \end{pmatrix}+
    \begin{pmatrix}
    0 \\
    \varepsilon_*^{-2}\mathbf{R}_*^{\text{coll}} \\
    \varepsilon_*^{-2}Q_*^{\text{coll}} 
    \end{pmatrix}, \label{equ:euler_rescaled}
\end{align}
\end{subequations}
with the equation of state $e_* = \frac{1}{2}|\mathbf{u_*}|^2 + \frac{p_*}{\varepsilon^2_* n_* (\gamma - 1)}$ and $h_* = e_* + \frac{p_*}{\varepsilon^2_* n_*}$. For a fully-ionized gas with only ions and electrons, 
\begin{equation} \label{equ:collision_rescaled} 
    \mathbf{R}_i^{\text{coll}} = \alpha^{\text{coll}}n_en_i(\mathbf{u}_i - \mathbf{u}_e) = - \mathbf{R}_e^{\text{coll}},
\end{equation}
and consequently, the rescaled friction heat for ions and electrons takes the expression
\begin{align*} 
    Q_i^{\text{coll}} &= \alpha^{\text{coll}}n_en_i \mathbf{u}_i (\mathbf{u}_i - \mathbf{u}_e), \\
    Q_e^{\text{coll}} &= \alpha^{\text{coll}}n_en_i \mathbf{u}_e (\mathbf{u}_e - \mathbf{u}_i).
\end{align*}

We end up getting the rescaled Maxwell-Euler system parameterized by $\lambda$.

\subsection{Quasi-neutral Limit} \label{sec:quasi-neutral_limit}
The Debye length $\lambda_D$ (see its definition in the preceding section) is the characteristic length over which local concentrations of charge are shielded. For the underlying physics, see \cite[Sec. 1.4]{chen2016}. In many situations, it has a rather low value compared to the reference length scale: the typical $\lambda_D$ for gas discharge and Tokamak is $10^{-4}$ m; for interstellar medium, the magnitude is about $1$ m \cite[ch. 20]{Blandford_2013}. That justifies the quasi-neutrality assumption that the plasma is locally neutral, i.e. $\rho = \sum_* q_*n_* = 0$. The limit model is obtained by formally setting the rescaled Debye length $\lambda$ to zero:
\vspace{-\baselineskip}
\begin{center}
    \begin{minipage}{0.3\textwidth}
\begin{subequations}
\begin{align*}
    \partial_t \mathbf{B} + \nabla \times \mathbf{E} &= 0 \tag{\ref{equ:maxwell_faraday_rescaled}},\\ 
    \lambda^2 \partial_t \mathbf{D} - \nabla \times \mathbf{H} &= - \mathbf{J}, \tag{\ref{equ:maxwell_ampere_rescaled}}\\
    \nabla \cdot \mathbf{B} &= 0, \tag{\ref{equ:maxwell_gauss_B_rescaled}}\\
    \lambda^2 \nabla \cdot \mathbf{D} &= \rho. \tag{\ref{equ:maxwell_gauss_D_rescaled}}
\end{align*}
\end{subequations}
\end{minipage}
\hspace{0.6cm}$\xrightarrow[]{\lambda \rightarrow 0}$
\begin{minipage}{0.3\textwidth}
\begin{subequations}
\begin{align}
    \partial_t \mathbf{B} + \nabla \times \mathbf{E} &= 0, \label{equ:maxwell_faraday_limit} \\ 
    - \nabla \times \mathbf{H} &= - \mathbf{J}, \label{equ:maxwell_ampere_limit} \\
    \nabla \cdot \mathbf{B} &= 0,  \label{equ:maxwell_gauss_B_limit}\\
     0 &= \rho. \label{equ:maxwell_gauss_D_limit}
\end{align}
\end{subequations}
\end{minipage}
\end{center}
The quasi-neutral condition (\ref{equ:maxwell_gauss_D_limit}) is the consequence of taking $\lambda = 0$ in Gauss's law for the electric field (\ref{equ:maxwell_gauss_D_rescaled}). Like the non-neutral case, Gauss's laws (\ref{equ:maxwell_gauss_B_limit}) (\ref{equ:maxwell_gauss_D_limit}) are the consequence of (\ref{equ:maxwell_faraday_limit}) (\ref{equ:maxwell_ampere_limit}) provided (\ref{equ:maxwell_gauss_B_limit}) (\ref{equ:maxwell_gauss_D_limit}) are satisfied at initial time. 


This limit poses a \emph{singular perturbation problem} in the sense that vanishing $\lambda$ changes the character of the PDE system. To be more specific, in the non-limit model the $\mathbf{E}$-field evolves with time whereas in the quasi-neutral model it responds instantaneously to other quantities according to the constraint (\ref{equ:maxwell_ampere_limit}). To make it clear, we replace (\ref{equ:maxwell_ampere_rescaled}) by the sum of the curl of (\ref{equ:maxwell_faraday_rescaled}) and the time-derivative of (\ref{equ:maxwell_ampere_rescaled}). Meanwhile exploiting the momentum equation in (\ref{equ:euler_rescaled}) to express $\partial_t\mathbf{J}$, we end up getting the equation that the $\mathbf{E}$-field satisfies
\begin{align}
    \lambda^2\partial_t^2 \mathbf{E} + \nabla \times \nabla \times \mathbf{E} &= - a\mathbf{E} - \mathbf{b}, \label{equ:E}
\end{align}
where
\begin{equation*}
    a = \sum_*\varepsilon_*^{-2}q_*^2n_*, \ \ \ \mathbf{b} = \sum_* \epsilon_*^{-2}q_*^2n_*\mathbf{u}_*\times\mathbf{B} - q_*\nabla\cdot(n_* \mathbf{u}_* \otimes \mathbf{u}_* + \varepsilon_*^{-2}p_*\mathbb{I}).
\end{equation*}
 (\ref{equ:E}) implies the shift from hyperbolic to elliptic for the evolution equations for the $\mathbf{E}$-field as $\lambda\rightarrow0$. 

\begin{remark}
    The preceeding formal limit argument is rather heuristic. Deep mathematical tools from perturbation theory is needed to rigorously prove the convergence of the limiting sequence. This topic is beyond the scope of this paper and thus omitted. Readers are referred to \cite[ch. 2]{remi_2014} \cite{Peng_2008} for the quasi-neutral limit of the Maxwell-Euler system, and \cite{mark_1995, Eckhaus_1980} for the general theory.
\end{remark} 

\subsection{Boundary Conditions} \label{sec:BC}

We consider a simply connected domain $\Omega$ that is decomposed into two sub-domains $\Omega_P$ and $\Omega_N$ representing plasma domain and non-conducting domain respectively. We use the notation $\Gamma_C := \partial\Omega \cap \partial\Omega_P$, denoting the contact boundary, and $\Gamma_I := \partial\Omega \cap \partial\Omega_N$ for the insulating boundary which an artificial cut-off boundary. The interface between the two domains is denoted by $\Gamma_W = \partial\Omega_I \cap \partial\Omega_P$. A geometric arrangement corresponding to this setting is sketched in Fig. \ref{fig:domain_sketch} and is the one used in \cite[][ch. 1, sec. 4]{fuchs_2021}. 

The plasma fills $\Omega_P$ where the Euler system is defined and the boundary of the plasma domain is $\partial\Omega_P$. We consider the physical scenario where plasmas are confined by solid insulator. Therefore, the interface $\Gamma_W$ is treated as reflective wall where fluid particles are bounced back while keeping the tangential velocity and energy unchanged. The contact boundary $\Gamma_C$ is where the plasma and energy flow across, modelled by open boundaries in the sense that fluids are free to flow through, i.e. ions and electrons are emitted and absorbed by the electrodes. 

\begin{remark}
    The treatment of electrodes as open boundary is a rather simplified approach. For more realistic electrode modelling, see \cite{godyak_1990, parker_1993}.
\end{remark}

The Maxwell system is defined on the whole domain $\Omega$. The insulating boundary blocks energy interchange and therefore only admits zero electric and magnetic flux, in the sense that $\text{curl}\mathbf{E}\cdot \mathbf{n} = 0$ and $\text{curl}\mathbf{H}\cdot \mathbf{n} = 0$ where $\mathbf{n}$ is the outer normal vector. We model the electrodes on the contact boundary $\Gamma_C = \Gamma_C^+\cup \Gamma_C^-$ which are two disjoint connecting components. A vanishing tangential component $\mathbf{E}_t$ of the $\mathbf{E}$-field is imposed on $\Gamma_C$. Since we have $\text{curl}\mathbf{E} \cdot \mathbf{n} = 0$ on the whole boundary $\partial\Omega$, there exists a scalar potential $\varphi$ defined on $\partial\Omega$ such that the tangential component $\mathbf{E}_t = \nabla_\Gamma \varphi$ where $\nabla_\Gamma$ denotes surface gradient. $\varphi$ is set constant in each component of $\Gamma_C$, i.e. external voltages are applied on the electrodes.
\begin{figure}
\begin{minipage}{0.45\textwidth}
    \resizebox{\textwidth}{!}{
    \begin{tikzpicture}
    \coordinate (O1) at (0,0);
    \draw[violet] (O1) circle (1) node[blue] {Electrode};
    \fill[blue, opacity=0.2] (O1) circle (1);
    \draw[very thick] (O1) circle (1.5);
    \coordinate (O2) at (4.5,1);
    \draw[violet] (O2) circle (1);
    \node at (O2) {\textcolor{red}{Electrode}};
    \node at (barycentric cs:O1=1,O2=1) {Plasma}; 
    \fill[red, opacity=0.2] (O2) circle (1);
    \coordinate (S1) at ([shift={(-0.196,0.98)}]O1);
    \coordinate (S2) at ([shift={(-0.196,0.98)}]O2);
    \coordinate (P1) at ([shift={(0.196,-0.98)}]O1);
    \coordinate (P2) at ([shift={(0.196,-0.98)}]O2);
    \draw[violet] (S1) -- (S2);
    \draw[violet] (P1) -- (P2);
    \coordinate (SS1) at ([shift={({-0.196*1.5},{0.98*1.5})}]O1);
    \coordinate (SS2) at ([shift={({-0.196*1.5},{0.98*1.5})}]O2);
    \coordinate (PP1) at ([shift={({0.196*1.5},{-0.98*1.5})}]O1);
    \coordinate (PP2) at ([shift={({0.196*1.5},{-0.98*1.5})}]O2);
    \draw[very thick] (SS1) -- (SS2);
    \draw[very thick] (PP1) -- (PP2); 
    \draw[black, very thick] (SS2) arc (101.31:180+101.31:1.5);
    \draw[very thick] (PP2) arc (101.31-180:101.31:1.5);
    \draw[-to] (barycentric cs:SS1=1,SS2=1,S1=1,S2=1) to[out=90,in=0] ([shift={(-0.5,0.5)}]barycentric cs:SS1=1,SS2=1,S1=1,S2=1) node[left, gray] {Insulator};
    \begin{scope}[shift={(5.5,-1.4)}]
    \draw[blue, -to] (0,0) -- (0.65,0.12) node[right]{\small $z$};
    \draw[blue, -to] (0,0) -- (0,0.7) node[above]{\small $x$};
    \draw[blue, -to] (0,0) -- (0.7,0) node[below]{\small $y$};
    \end{scope}
    \end{tikzpicture}}
\end{minipage}
\begin{minipage}{0.49\textwidth}
    \resizebox{1.1\textwidth}{!}{ \begin{tikzpicture}
        \coordinate (A1) at (0,1.5);
        \coordinate (A2) at (0,1);
        \coordinate (A3) at (0,-1);
        \coordinate (A4) at (0,-1.5);
        \coordinate (B1) at (6,1.5);
        \coordinate (B2) at (6,1);
        \coordinate (B3) at (6,-1);
        \coordinate (B4) at (6,-1.5);
        \draw[violet] (A2) -- node[above]{\color{gray}Non-conducting domain $\Omega_N$} node[black, below]{\textcolor{violet}{$\Gamma_W$}} (B2);
        \draw[violet] (A3) -- node[below]{\color{gray}Non-conducting domain $\Omega_N$} node[black, above]{\textcolor{violet}{$\Gamma_W$}} (B3);
        \draw[very thick] (A2) -- (A1) -- node[above]{$\Gamma_I$}  (B1) -- (B2);
        \draw[very thick] (A3) -- (A4) -- node[below]{$\Gamma_I$} (B4) -- (B3);
        \draw[very thick, dashed, blue] (A2) -- node[left] {$\Gamma_C^-$} (A3);
        \draw[very thick, dashed, red]  (B2) -- node[right] {$\Gamma_C^+$}  (B3);
        \node at (3,0) {Plasma domain $\Omega_P$};
        \begin{scope}[shift={(6.5,-1.6)}]
        \draw[blue, -to] (0,0) -- (0,0.7) node[above]{\small $x$};
        \draw[blue, -to] (0,0) -- (0.7,0) node[right]{\small $z$};
        \end{scope}
    \end{tikzpicture}}
\end{minipage}
\caption{Sketch of the domain. The right figure shows the cross section in the $x$-$z$ plane.}
\label{fig:domain_sketch}
\end{figure}


    To summarize the boundary conditions for both systems:
    
\vspace{10pt}
\begin{minipage}[t]{0.49\textwidth}
    \textbf{For the Euler equations:}
    \begin{align*}
    \mathbf{u_*}\cdot \mathbf{n} &= 0 \ \ \text{on} \ \ \Gamma_W, \\
    \text{grad}\mathbf{u_*} \cdot \mathbf{n} &= \mathbf{0} \ \ \text{on} \ \ \Gamma_C, \\
    \text{grad}n_* \cdot \mathbf{n} &= 0 \ \ \text{on} \ \ \Gamma_W \cup \Gamma_C, \\
    \text{grad}e_* \cdot \mathbf{n} &= 0 \ \ \text{on} \ \ \Gamma_W \cup \Gamma_C.
\end{align*}
\end{minipage}
\begin{minipage}[t]{0.49\textwidth}
    \textbf{For Maxwell's equations:}
    \begin{align*}
    \text{curl} \mathbf{E} \cdot \mathbf{n} = 0\ \ &\text{on} \ \  \partial\Omega,  \\
    \text{curl} \mathbf{H} \cdot \mathbf{n} = 0\ \ &\text{on} \ \  \Gamma_I,  \\
    \varphi = \varphi^\pm(t)\ \ &\text{on} \ \ \Gamma_C^\pm.
    \end{align*}
\end{minipage}

\vspace{10pt}
\begin{remark}
    No boundary conditions for Maxwell's equations are needed on $\Gamma_W$.
\end{remark}

\begin{remark} For a geometric setting with non-trivial geometry, e.g. with a tunnel, \emph{curl}$\mathbf{E}\cdot\mathbf{n}$ does not lead to the existence of a surface potential $\varphi:\mathbf{E}_t = \nabla_\Gamma\varphi$. One needs to consider co-homology vector fields \cite{Hiptmair_2021}.
\end{remark}



\subsection{Reformulation} \label{sec:reform_continuous}
In the non-conducting domain $\Omega_N$ (see Fig. \ref{fig:domain_sketch}), the Euler system is not defined there due to the absence of plasmas. Consequently, the Maxwell system in $\Omega_N$ is described by
\begin{subequations}
\begin{align}
    \partial_t \mathbf{B} + \nabla \times \mathbf{E} &= 0, \label{equ:faraday_ins}\\ 
    \lambda^2 \partial_t \mathbf{D} - \nabla \times \mathbf{H} &= 0,  \label{equ:ampere_ins}\\
    \nabla \cdot \mathbf{B} &= 0, \label{equ:gauss_B_ins}\\
    \lambda^2 \nabla \cdot \mathbf{D} &= 0 \label{equ:gauss_D_ins}.
\end{align}
\end{subequations}

In non-neutral regime where $\lambda = \mathcal{O}(1)$, the Maxwell system in $\Omega_N$ is well-posed and Gauss's laws (\ref{equ:gauss_B_ins}) (\ref{equ:gauss_D_ins}) are redundant as long as they are satisfied at initial time. Nonetheless, as the system approaches the quasi-neutral limit as $\lambda \rightarrow 0$, Gauss's law for $\mathbf{D}$-field (\ref{equ:gauss_D_ins}) becomes degenerate. Due to limited machine precision, schemes based on this set of PDEs would become unstable as $\lambda \rightarrow 0$. The vanishing divergence would break down as $\nabla \cdot \mathbf{D} = 0/\lambda^2 = 0$ would not hold numerically when $\lambda^2$ becomes extremely small. 

To see this issue from another perspective, we examine the limit Maxwell system in $\Omega_N$
\begin{subequations}
\begin{align}
    \partial_t \mathbf{B} + \nabla \times \mathbf{E} &= 0, \label{equ:faraday_ins_limit}\\ 
    - \nabla \times \mathbf{H} &= 0,  \label{equ:ampere_ins_limit}\\
    \nabla \cdot \mathbf{B} &= 0, \label{equ:gauss_B_ins_limit}\\
    \nabla \cdot \mathbf{D} &= 0 \label{equ:gaus_D_ins_limit}.
\end{align}
\end{subequations}

Again, Gauss's law for the $\mathbf{B}$-field (\ref{equ:gauss_B_ins_limit}) is redundant while Gauss's law for $\mathbf{D}$-field (\ref{equ:gaus_D_ins_limit}) is no longer the consequence of Amper\`{e}'s law. However, it is essential for the well-posedness of the problem \citep{ana_2010}. From this perspective, the degeneracy of Gauss's law for $\mathbf{D}$-field in the system (\ref{equ:faraday_ins_limit}) to (\ref{equ:gaus_D_ins_limit}) as $\lambda \rightarrow 0$ poses some problem.

In other words, the set of equations (\ref{equ:faraday_ins_limit}) to (\ref{equ:gaus_D_ins_limit}) ``approaches" an ill-posed situation as $\lambda \rightarrow 0$. This is totally fine in the continuous level while it could be problematic in the discrete level due to a limited floating-point precision. 

We propose the following reformulation as a remedy, which introduces a Lagrange multiplier $\psi$ and removes the $\lambda^2$ prefactor in Gauss's law for $\mathbf{D}$-field:
\begin{subequations}
\begin{align}
    \partial_t \mathbf{B} + \nabla \times \mathbf{E} &= 0, \label{equ:faraday_ins_reform}\\ 
    \lambda^2 \partial_t \mathbf{D} - \nabla \times \mathbf{H} + \colorbox{orange!20}{$\nabla \psi$} &= 0,  \label{equ:ampere_ins_reform}\\
    \nabla \cdot \mathbf{B} &= 0, \label{equ:gauss_B_ins_reform}\\
    \nabla \cdot \mathbf{D} &= 0 \label{equ:gauss_D_ins_reform}.
\end{align}
\end{subequations}

Supplemented with the boundary condition $\psi = 0$ on $\partial\Omega_N$, one can check that (\ref{equ:faraday_ins_reform}) to (\ref{equ:gauss_D_ins_reform}) are equivalent to the original formulation (\ref{equ:faraday_ins})-(\ref{equ:gauss_D_ins}) by verifying that $\psi = 0$ in $\Omega_N$. This is done by taking the divergence of (\ref{equ:ampere_ins_reform}) such that the Laplace equation of $\psi$ with zero Dirichlet boundary condition gives vanishing $\psi$. The importance of this reformulation will be made clear in the numerical experiment. 

We would like to point out that this reformulation is not needed in the plasma domain $\Omega_P$ since the Maxwell system is uniformly well-posed for $\lambda \in [0,1]$ thanks to the existence of an electric current and its dependence on the $\mathbf{E}$-field. 

\begin{comment}
To devise an AP scheme, the dependence of the stability constraints of $h$ on $\lambda$ has to be removed. This is mainly achieved by utilizing implicit time-stepping for certain terms. As is summarized by \cite{degond_2017}, AP schemes aim to bridge several sets of equations describing the system in different regimes, rather than to alleviate the stability constraints of the numerical methods. In this sense, a fully-implicit scheme is likely to be overkill and thus a smart construction is necessary. The second consideration goes to the identification of a compatible boundary conditions for both regimes, which would be shown to be essential for the numerical stability.      

In the following sections, we first briefly discuss the 1D scheme for the Maxwell-Euler system devised by \cite{degond_2012} on which our work us built. This section also serves as a preliminary case study such that readers can better understand the 3D scheme.
\end{comment}

\section{Spatial Discretization} \label{sec:spatial_discretization}
\subsection{Primal-dual Staggered Meshes} \label{sec:mesh-duality}
\subsubsection{Geometric Property}
Prior to the spatial discretization of the Maxwell-Euler system, we introduce primal-dual staggered meshes that are necessary in the discretization framework we use. The spatial domain is discretized by two meshes that interlace with each other, denoted by a mesh doublet $(\mathcal{M}, \Tilde{\mathcal{M}})$ for primal mesh and dual mesh respectively. The fundamental duality property requires that \emph{each edge of one mesh penetrates a face of the other mesh and that each vertex of one mesh lies inside of a cell of the other mesh} \citep{weiland_2003}, which makes $(\mathcal{M}, \Tilde{\mathcal{M}})$ staggered. A simple example for Cartesian meshes is shown in Fig. \ref{fig:cartesian}.

To clarify the notation, in three dimensions the primal mesh $\mathcal{M}$ is a cell complex defined by the set of elements $\{P, L, A, V\}$\footnote{The notation here is a bit floppy. $P, L, A, V$ can refer to a single element or a set of elements.} denoting \emph{vertices, edges, faces} and \emph{cells} respectively. In the same way, the dual mesh $\Tilde{\mathcal{M}}$ is defined by $\{\Tilde{P}, \Tilde{L}, \Tilde{A}, \Tilde{V}\}$. Elements of two meshes are associated with bijective pairings $P \leftrightarrow \Tilde{V}$, $L \leftrightarrow \Tilde{A}$, $A \leftrightarrow \Tilde{L}$ and $V \leftrightarrow \Tilde{P}$ which arise in a very natural way: $P(\Tilde{P} \text{ resp.})$ corresponds to $\Tilde{V}(V \text{ resp.})$ where it lies and $L(\Tilde{L} \text{ resp.})$ penetrates its corresponding $\Tilde{A}(A \text{ resp.})$. According to their dimensions, vertices, edges, faces and cells are also termed 0-dim, 1-dim, 2-dim and 3-dim elements respectively. Meanwhile, we denote by $N_\ast, \ast \in \{P, \Tilde{P}, L, \Tilde{L},A, \Tilde{A},V, \Tilde{V}\}$ the total number of elements in $\mathcal{M}, \Tilde{\mathcal{M}}$. 

First, we illustrate the 2D case and construct the meshes based on the Delaunay-Voronoi approach: we start with a Delaunay triangulation $\mathcal{M}$ of the domain and construct $\Tilde{\mathcal{M}}$ by connecting \emph{circumcenters} of any two adjacent triangles, see Fig. \ref{fig:2d-mesh}.

In three dimensions, the meshes are constructed by extruding the 2D meshes vertically along one axis in a staggered manner \cite{Marrone_2001}. See an example in Fig. \ref{fig:2d-extrusion}. In this way, the meshes are composed of prisms. This particular choice is compatible with the cylindrical geometric setting that we are in, see Fig. \ref{fig:domain_sketch}. For a general setting, one can directly decompose the domain into tetrahedrons and constructs the Voronoi grid, but the procedure is more complicated and time-consuming and may not yield a valid dual mesh. The full discretization of the cylindrical domain is given in Fig. \ref{fig:primal_dual_meshes}. 

The geometric orthogonality between $L \leftrightarrow \Tilde{A}$ and $A \leftrightarrow \Tilde{L}$ is satisfied and would be a crucial property for approximating the material laws shown in the following section. 

\begin{remark}
    The use of the Delaunay-Voronoi based primal-dual meshes is problematic when there are obtuse-angle triangles in $\mathcal{M}$. In this case their circumcenters lie outside the triangles and the intersection between edges and faces is violated. An alternative approach is barycenter-based dual meshes, which are not restricted to an acute-angle triangulation \cite{Marrone_2001}. 
\end{remark}



\begin{figure}
    \begin{subfigure}[b]{0.3\textwidth}
    \centering
    \resizebox{0.45\textwidth}{!}{\begin{tikzpicture}
    \def\primalstyle{thick}
    \def\dualstyle{ultra thick}
    \coordinate (P0) at (0cm, 0cm);
    \foreach \i in {1,2,...,6}
    {
    \coordinate (P\i) at ({60*\i-30}:2cm);
    \draw[\primalstyle] (P0) -- (P\i);
    }
    \draw[\primalstyle] (P1) -- (P2) node[above=3mm]{\Large $\mathcal{M}$} node[left=11mm]{\Large \color{blue} $\Tilde{\mathcal{M}}$} -- (P3) -- (P4) -- (P5) -- (P6) -- cycle;
    \foreach \i in {1,2,...,6}
    {
    \coordinate (D\i) at ({60*\i-60}:{2./1.737});
    \coordinate (DD\i) at ({60*\i-60}:{4./1.737});
    }
    \draw[blue,\dualstyle] (D1) -- (D2) -- (D3) -- (D4) -- (D5) -- (D6) -- cycle;
    \foreach \i in {1,2,...,6}
    {
    \draw[blue,\dualstyle] (D\i) -- (DD\i);
    }
    \fill[blue!50, opacity=0.2] (D1) -- (D2) -- (D3) -- (D4) -- (D5) -- (D6) -- cycle;
    \end{tikzpicture}}
    \caption{2D case}
    \label{fig:2d-mesh}
    \end{subfigure}
    \begin{subfigure}[b]{0.35\textwidth}
    \centering
    \resizebox{0.8\textwidth}{!}{\begin{tikzpicture}
    \def\primalstyle{thick}
    \def\dualstyle{thick}
    \coordinate (P0) at (0cm, 0cm);
    \foreach \i in {1,2,...,6}
    {
    \coordinate (P\i) at ({60*\i-30}:2cm);
    \draw[\primalstyle] (P0) -- (P\i);
    }
    \draw[\primalstyle] (P1) -- (P2) node[left=5mm]{\Large $\mathcal{M}$} -- (P3) -- (P4) -- (P5) -- (P6) -- cycle;
    \begin{scope}[shift={(3cm,0.5cm)}]
        \coordinate (PP0) at (0cm, 0cm);
        \foreach \i in {1,2,...,6}
        {
        \coordinate (PP\i) at ({60*\i-30}:2cm);
        \draw[gray] (PP0) -- (PP\i);
        }
    \end{scope}
    
    \draw[\primalstyle] (PP1) -- (PP2);
    \draw[gray] (PP2) -- (PP3);
    \draw[gray] (PP3) -- (PP4);
    \draw[gray] (PP4) -- (PP5);
    \draw[\primalstyle] (PP5) -- (PP6);
    \draw[\primalstyle] (PP6) -- (PP1);
    
    \draw[gray] (P0) -- (PP0);
    \draw[\primalstyle] (P1) -- (PP1);
    \draw[\primalstyle] (P2) -- (PP2);
    \draw[gray] (P3) -- (PP3);
    \draw[gray] (P4) -- (PP4);
    \draw[\primalstyle] (P5) -- (PP5);
    \draw[\primalstyle] (P6) -- (PP6);
    
    \foreach \i in {1,2,...,6}
    {
    \coordinate (D\i) at ({60*\i-60}:{2./1.737});
    }
    \draw[dashed, blue] (D1) -- (D2) -- (D3) -- (D4) -- (D5) -- (D6) -- cycle;
    \begin{scope}[shift={(1.5,0.25)}]
        \foreach \i in {1,2,...,6}
        {
        \coordinate (DD\i) at ({60*\i-60}:{2./1.737});
        }
    \end{scope}
    \draw[blue] (DD1) -- (DD2) -- (DD3) -- (DD4) -- (DD5) -- (DD6) -- cycle;
    \draw[blue] (D1) -- (DD1);
    \draw[blue] (D2) -- (DD2);
    \draw[blue] (D3) -- (DD3);
    \draw[blue] (D4) -- (DD4);
    \draw[blue] (D5) -- (DD5);
    \draw[blue] (D6) -- (DD6);
    
    \begin{scope}[shift={(-1.5,-0.25)}]
        \foreach \i in {1,2,...,6}
        {
        \coordinate (DDD\i) at ({60*\i-60}:{2./1.737});
        }
    \end{scope}
    \draw[blue, ultra thick] (DDD1) -- (DDD2) -- (DDD3) node[left=3mm]{\textcolor{blue}{\Large $\Tilde{\mathcal{M}}$}} -- (DDD4) -- (DDD5) -- (DDD6) -- cycle;
    \draw[blue, ultra thick] (D1) -- (DDD1);
    \draw[blue, ultra thick] (D2) -- (DDD2);
    \draw[blue, ultra thick] (D3) -- (DDD3);
    \draw[blue] (D4) -- (DDD4);
    \draw[blue] (D5) -- (DDD5);
    \draw[blue, ultra thick] (D6) -- (DDD6);
    \fill[blue!50, opacity=0.2] (D1) -- (D2) -- (D3) -- (D4) -- (D5) -- (D6);
    \end{tikzpicture}}
    \caption{3D case (2D extrusion)}
    \label{fig:2d-extrusion}
    \end{subfigure}
    \begin{subfigure}[b]{0.35\textwidth}
    \centering
    \begin{tikzpicture}[scale = 0.2]
            \def\style{thick}
            \draw[\style] (0,0) -- (1.5,0);
            \draw[\style] (0,0) -- (0,5) -- (5,5) -- (5,2.5);
            \draw[\style] (0,5) -- (2,7) node[left]{$\mathcal{M}$} -- (7,7) -- (5,5);
            \draw[\style] (7,7) -- (7,3.5);
            \draw[dashed, very thin] (1.5, 0) -- (5,0);
            \draw[dashed, very thin] (5,0) -- (5,2.5);
            \draw[dashed, very thin] (5,0) -- (7,2);
            \draw[dashed, very thin] (7,2) -- (7,3.5);
            
            \draw[fill = gray!60,\style] (5,2.5) -- (6,3.5) -- (7,3.5) -- (7,7) -- (5,5) -- cycle;
            \draw[fill = gray!10,\style] (0,5) -- (5,5) -- (7,7) -- (2,7) -- cycle;
            \draw[dashed, very thin] (5,0) -- (6.5,1.5) -- (5,1.5) -- cycle;
            
            \begin{scope}[shift={(1.5,-3.5)}]
            \draw[blue,\style] (0,0) -- (5,0)  node[right]{$\Tilde{\mathcal{M}}$};
            \draw[blue,\style] (5,0) -- (5,5);
            \draw[blue,\style] (5,5) -- (0,5);
            \draw[blue,\style] (0,5) -- (0,0);
            \draw[blue,\style] (0,5) -- (1,6);
            \draw[blue,\style] (4.5,7) -- (7,7);
            \draw[blue,\style] (7,7) -- (5,5);
            \draw[blue,\style] (7,7) -- (7,2);
            \draw[blue,\style] (7,2) -- (5,0);
            \draw[dashed, very thin] (1,6) -- (2,7);
            \draw[dashed, very thin] (2,7) -- (4.5,7);
            \draw[fill = blue!10,\style] (0,5) -- (5,5) -- (7,7) -- (4.5,7) -- (3.5, 6) -- (1,6) -- cycle;
            \draw[fill = blue!40,\style] (5,0) -- (7,2) -- (7,7) -- (5,5) -- cycle;
            \draw[dashed, very thin] (1,6) -- (2,7) -- (3.5,7) -- (3.5,6) -- cycle;
            \end{scope}
        \end{tikzpicture}
        \caption{3D case (Cartesian)}
        \label{fig:cartesian}
    \end{subfigure}
    \hfill
    \caption{Illustration of primal and dual meshes. (a) A Delaunay-Voronoi grid in 2D (b) The extrusion of 2D mesh. Six triangle prisms are primal cells (depicted by black and gray edges). One dual cell, which is a hexagon prism, is depicted by blue edges. The dashed hexagon represents the intersection of the dual cell and primal cells. (c) A Cartesian case.}
    \label{fig:illustration_primal_dual}
\end{figure}

\subsubsection{Orientation and Incidence Matrices}
Each geometric element in the primal mesh $\mathcal{M}$ is (arbitrarily) endowed with an \emph{internal orientation}\footnote{This notion should not be aliased with \emph{inner orientation}, which has a slightly different definition, see \cite{tonti_2002}.}. The notion is sketched in Fig. \ref{fig:orientation}. For the elements of the dual mesh $\Tilde{\mathcal{M}}$, we set their internal orientations to be aligned with their corresponding primal elements according to the bijective pairings, i.e. edges penetrate faces.

Another orientation attribute, \emph{induced orientation}, is defined as follows: an induced orientation of a k-dim element $f$ with respect to a (k+1)-dim element $f'$, satisfying $f \subset \partial f' $, is determined by the internal orientation of $f'$ according to the rule shown in Fig. \ref{fig:orientation}. 

This information can be captured by matrices with entries in $\{0,-1,+1\}$, called \emph{incidence matrices}. To describe the primal face-to-edge relation, for instance, a sparse matrix $\mathbb{C} \in \mathbb{R}^{N_A \times N_L}$ is assembled whose $(i,j)$-entry is assigned $+1$ if the internal orientation of edge $L_j$ and its induced orientation with respect to face $A_i$ coincides; it is assigned $-1$ if two orientations are opposite; and assigned $0$ if $L_j$ is not a subset of the boundary of $A_i$. We will see later that $\mathbb{C}$ functions as a discrete version of the curl operator. The other incidence matrices are constructed in the same manner, see Tab. \ref{tab:incidence_mat} for a summary. Given the link of orientations of $\mathcal{M}$ and $\Tilde{\mathcal{M}}$, we can derive the relations listed in Tab. \ref{tab:incidence_relation}.  

\begin{table}[h!]
    \centering
    \begin{tabular}{c c c c}
    \hline
         Matrix & Size & Incidence relation & Intuition  \\
    \hline
         $\mathbb{D}\ (\Tilde{\mathbb{D}})$ & $N_V \times N_A\ (N_{\Tilde{V}} \times N_{\Tilde{A}})$ & cell $\rightarrow$ face & discrete div \\
         $\mathbb{C}\ (\Tilde{\mathbb{C}})$ & $N_A \times N_L\ (N_{\Tilde{A}} \times N_{\Tilde{L}})$ & face $\rightarrow$ edge & discrete curl \\
         $\mathbb{G}\ (\Tilde{\mathbb{G}})$ & $N_L \times N_P\ (N_{\Tilde{L}} \times N_{\Tilde{P}})$ & edge $\rightarrow$ vertex & discrete grad \\
    \hline
    \end{tabular}
    \caption{Summary of incidence matrices}
    \label{tab:incidence_mat}
\end{table}

\begin{table}[h!]
    \centering
    \begin{tabular}{l c}
    \hline
         Relation & Intuition \\
    \hline
         $\mathbb{G}^T = -\Tilde{\mathbb{D}}$  &  $\text{grad}^* = - \text{div}$\\
         $\mathbb{C}^T = \Tilde{\mathbb{C}}$   &  $\text{curl}^* = - \text{curl}$\\
         $\mathbb{D}^T = -\Tilde{\mathbb{G}}$  &  $\text{div}^* = - \text{grad}$\\
         $\mathbb{C}\mathbb{G} = \mathbf{0}, \Tilde{\mathbb{C}}\Tilde{\mathbb{G}} = \mathbf{0}$  &  curl $\circ$ grad = 0 \\
         $\mathbb{D}\mathbb{C} = \mathbf{0}, \Tilde{\mathbb{D}}\Tilde{\mathbb{C}} = \mathbf{0}$   &  div $\circ$ curl = 0 \\
    \hline
        \small $\ast$ denotes adjoint operator.
    \end{tabular}
    \caption{Relations between incidence matrices}
    \label{tab:incidence_relation}
\end{table}

These matrices are topological and thus invariant under smooth deformation of the domain. In the next section, we will show that they play a crucial role in constructing discrete Maxwell's equations. 

\begin{figure}
    \centering
    \begin{minipage}{0.2\textwidth}
    \centering
    \begin{tikzpicture}
        \coordinate (P0) at (0,0);
        \coordinate (P1) at (10:1); 
        \coordinate (P2) at (90:1);
        \coordinate (P3) at (190:1);
        \coordinate (P4) at (270:1);
        \coordinate (P5) at (135:0.6);
        \coordinate (P6) at (-45:0.6);
        \foreach \i in {1,2,...,6} 
        {
            \draw[decoration={markings, mark= at position 0.5 with {\arrow[scale=1.5]{stealth}}},postaction={decorate}] (P\i) -- (P0);
        }
        \draw[fill=black] (P0) circle (0.07) node[yshift=15pt, xshift=12pt]{P}; 
    \end{tikzpicture}
    \end{minipage}
    \begin{minipage}{0.2\textwidth}
    \begin{tikzpicture}
        \coordinate (P1) at (0,0);
        \coordinate (P2) at (10:1.8);
        \draw[decoration={markings, mark= at position 0.55 with {\arrow[scale=1.5]{stealth}}},postaction={decorate}, thick] (P1) -- node[above=2mm]{$L$} (P2);
        \draw[blue, fill=blue] (P1) circle (0.07) node[above=2mm] {\color{blue}$P_1$} node[below=2mm] {\color{blue}$(-)$};
        \draw[blue, fill=blue] (P2) circle (0.07) node[above=2mm] {\color{blue}$P_2$} node[below=2mm] {\color{blue}$(+)$};
    \end{tikzpicture}
    \end{minipage}
    \begin{minipage}{0.2\textwidth}
    \begin{tikzpicture}
        \coordinate (Q1) at (0,0);
        \coordinate (Q2) at (1.3cm, -0.46cm);
        \coordinate (Q3) at (2.0cm, 0.7cm);
        \draw[decoration={markings, mark= at position 0.5 with {\arrow[scale=1]{stealth}}}, postaction={decorate}, thick, blue] (Q1) -- node[below=1.5mm]{$L_1$} (Q2);
        \draw[decoration={markings, mark= at position 0.5 with {\arrow[scale=1]{stealth}}}, postaction={decorate},  thick, blue] (Q2) -- node[right,yshift=-1.5mm]{$L_2$} (Q3);
        \draw[decoration={markings, mark= at position 0.5 with {\arrow[scale=1]{stealth}}}, postaction={decorate},  thick, blue] (Q3) -- node[above,xshift=-3mm] {$L_3$}(Q1);
        \fill[black!50, opacity=0.25] (Q1) -- (Q2) -- (Q3);
        \draw[-stealth](barycentric cs:Q1=1,Q2=1,Q3=1) -- ([shift={(0,1cm)}] barycentric cs:Q1=1,Q2=1,Q3=1) node[right,xshift=1mm] {$A$}; 
    \end{tikzpicture}
    \end{minipage}
    \begin{minipage}{0.2\textwidth}
    \begin{tikzpicture}
        \coordinate (S1) at (0,0);
        \coordinate (S2) at (-0.7,0.3);
        \coordinate (S3) at (1.1,0.7);
        \coordinate (S4) at (0.3,1.7);
        \draw[thick] (S1) -- (S2) -- (S4) -- cycle;
        \fill[blue!50, opacity=0.2] (S1) -- (S2) -- (S4);
        \draw[thick] (S1) -- (S3) -- (S4) -- cycle;
        \fill[blue!50, opacity=0.2] (S1) -- (S3) -- (S4);
        \draw[thin] (S2) -- (S3);
        \draw[-stealth, blue] (barycentric cs:S1=1,S2=1,S4=1) -- ([shift={(-0.7,0.3)}] barycentric cs:S1=1,S2=1,S4=1) node[above] {$A_1$};
        \coordinate (O1) at (barycentric cs:S1=1,S2=1,S3=1);
        \coordinate (O2) at ([shift={(0,-0.7)}] barycentric cs:S1=1,S2=1,S3=1);
        \coordinate (S)  at (intersection of O1--O2 and S1--S3);
        \draw[dashed] (O1) -- (S);
        \draw[-stealth, blue] (S) -- (O2) node[right] {$A_2$};
        \draw[-stealth, blue] (barycentric cs:S1=1,S3=1,S4=1) -- ([shift={(0.7,0.3)}] barycentric cs:S1=1,S3=1,S4=1) node[right] {$A_3$} ;
        \coordinate (OO1) at (barycentric cs:S2=1,S3=1,S4=1);
        \coordinate (OO2) at ([shift={(-0.3,0.9)}] barycentric cs:S2=1,S3=1,S4=1);
        \coordinate (SS)  at (intersection of OO1--OO2 and S2--S4);
        \draw[dashed, blue] (OO1) -- (SS);
        \draw[-stealth, blue] (SS) -- (OO2) node[left] {$A_4$};
        \node at (S4) [right, xshift=2mm] {$V$};
    \end{tikzpicture}
    \end{minipage}
    \caption{Illustration of internal and induced orientations. The internal orientation of each element is depicted in black color: vertices are oriented as \emph{sink} by default; edges are oriented by their pointing direction; faces are oriented by their normal vector; cells are oriented as positive default. The induced orientations are depicted in blue color: the ending vertex of an edge is negatively oriented while the starting point is positively oriented; the orientations of edges with respect to a face obey the right-hand rule; a face of a cell are oriented by its outer normal vector. }
    \label{fig:orientation}
\end{figure}

\subsubsection{Cut-off Boundary}
The primal mesh $\mathcal{M}$ is first generated and resolves the domain boundary. The dual mesh $\mathcal{M}'$ is generated afterwards. To make both meshes aligned at boundary, we have to truncate the \emph{dual} elements near the boundary due to the staggered character. In the meantime, auxiliary geometric entities are needed to close $\Tilde{\mathcal{M}}$, see Fig. \ref{fig:illustraion_dual_boundary}.

Note that the auxiliary edges might not be straight and the auxiliary faces might not be flat as is shown in Fig. \ref{fig:illustraion_dual_boundary}, which necessitates a versatile data structure to include such situations. In the following, the auxiliary elements would be treated as dual elements, which limits the validity of the relations in Tab. \ref{tab:incidence_relation} to interior part of $\Tilde{\mathcal{M}}$.

\begin{figure}
    \begin{subfigure}[b]{0.3\textwidth}
        \centering
        \begin{tikzpicture}
            \colorlet{dual}{blue}
            \tkzDefPoint(0,0){P1} 
            \tkzDefPoint(1,1){P1}
            \tkzDefPoint(1.1,-0.8){P2} 
            \tkzDefPoint(0.4,-1.4){P3} 
            \tkzDefPoint(2,0.9){P4} 
            \tkzDefPoint(1.4, 0){P5}
            \tkzDefPoint(2.3, 0){P6}
            \tkzDefPoint(2.1,-1){P7} 
            \tkzDefPoint(1.6,-1.7){P8} 
            \foreach \i in {0,...,8} {\tkzDrawPoints(P\i)}
            %\foreach \i in {0,...,8} {\tkzLabelPoints(P\i)}
            \tkzDrawSegments(P1,P0 P1,P4 P1,P5 P5,P0 P5,P4 P5,P2 P5,P6 P4,P6 P0,P2 P2,P7 P5,P7 P6,P7 P3,P0 P3,P2 P3,P8 P2,P8 P8,P7)
            \tkzDefTriangleCenter[circum](P1,P0,P5) \tkzGetPoint{O1} 
            \tkzDefTriangleCenter[circum](P1,P4,P5) \tkzGetPoint{O2}
            \tkzDefTriangleCenter[circum](P4,P6,P5) \tkzGetPoint{O3}
            \tkzDefTriangleCenter[circum](P2,P0,P5) \tkzGetPoint{O4} 
            \tkzDefTriangleCenter[circum](P2,P7,P5) \tkzGetPoint{O5}
            \tkzDefTriangleCenter[circum](P2,P0,P3) \tkzGetPoint{O6}
            \tkzDefTriangleCenter[circum](P2,P3,P8) \tkzGetPoint{O7}
            \tkzDefTriangleCenter[circum](P2,P7,P8) \tkzGetPoint{O8}
            \tkzDefTriangleCenter[circum](P5,P6,P7) \tkzGetPoint{O9}
            \foreach \i in {1,...,9} {\tkzDrawPoints[dual](O\i)}
            %\foreach \i in {1,...,9} {\tkzLabelPoints(O\i)}
            \tkzDrawSegments[dual](O1,O2 O2,O3 O3,O9 O9,O5 O5,O4 O1,O4 O4,O6 O6,O7 O7,O8 O8,O5 O5,O9)
            \tkzDefMidPoint(P0,P1) \tkzGetPoint{M0} \tkzDrawSegment[dual, add= 0 and 1](O1, M0)
            \tkzDefMidPoint(P1,P4) \tkzGetPoint{M1} \tkzDrawSegment[dual, add= 0 and 1](O2, M1)
            \tkzDefMidPoint(P4,P6) \tkzGetPoint{M2} \tkzDrawSegment[dual, add= 0 and 1](O3, M2)
            \tkzDefMidPoint(P6,P7) \tkzGetPoint{M3} \tkzDrawSegment[dual, add= 0 and 1](O9, M3)
            \tkzDefMidPoint(P7,P8) \tkzGetPoint{M4} \tkzDrawSegment[dual, add= 0 and 1](O8, M4)
            \tkzDefMidPoint(P3,P8) \tkzGetPoint{M5} \tkzDrawSegment[dual, add= 0 and 1](O7, M5)
            \tkzDefMidPoint(P0,P3) \tkzGetPoint{M6} \tkzDrawSegment[dual, add= 0 and 1](O6, M6)
        \end{tikzpicture}
        \caption{Before cut-off}
    \end{subfigure}
    \begin{subfigure}[b]{0.3\textwidth}
        \centering
        \begin{tikzpicture}
            \colorlet{dual}{blue}
            \colorlet{aux}{orange}
            \tkzDefPoint(0,0){P1} 
            \tkzDefPoint(1,1){P1}
            \tkzDefPoint(1.1,-0.8){P2} 
            \tkzDefPoint(0.4,-1.4){P3} 
            \tkzDefPoint(2,0.9){P4} 
            \tkzDefPoint(1.4, 0){P5}
            \tkzDefPoint(2.3, 0){P6}
            \tkzDefPoint(2.1,-1){P7} 
            \tkzDefPoint(1.6,-1.7){P8} 
            \foreach \i in {0,...,8} {\tkzDrawPoints(P\i)}
            %\foreach \i in {0,...,8} {\tkzLabelPoints(P\i)}
            \tkzDrawSegments(P1,P0 P1,P4 P1,P5 P5,P0 P5,P4 P5,P2 P5,P6 P4,P6 P0,P2 P2,P7 P5,P7 P6,P7 P3,P0 P3,P2 P3,P8 P2,P8 P8,P7)
            \tkzDefTriangleCenter[circum](P1,P0,P5) \tkzGetPoint{O1} 
            \tkzDefTriangleCenter[circum](P1,P4,P5) \tkzGetPoint{O2}
            \tkzDefTriangleCenter[circum](P4,P6,P5) \tkzGetPoint{O3}
            \tkzDefTriangleCenter[circum](P2,P0,P5) \tkzGetPoint{O4} 
            \tkzDefTriangleCenter[circum](P2,P7,P5) \tkzGetPoint{O5}
            \tkzDefTriangleCenter[circum](P2,P0,P3) \tkzGetPoint{O6}
            \tkzDefTriangleCenter[circum](P2,P3,P8) \tkzGetPoint{O7}
            \tkzDefTriangleCenter[circum](P2,P7,P8) \tkzGetPoint{O8}
            \tkzDefTriangleCenter[circum](P5,P6,P7) \tkzGetPoint{O9}
            \foreach \i in {1,...,9} {\tkzDrawPoints[dual](O\i)}
            %\foreach \i in {1,...,9} {\tkzLabelPoints(O\i)}
            \tkzDrawSegments[dual](O1,O2 O2,O3 O3,O9 O9,O5 O5,O4 O1,O4 O4,O6 O6,O7 O7,O8 O8,O5 O5,O9)
            \tkzDefMidPoint(P0,P1) \tkzGetPoint{M0} \tkzDrawSegment[dual](O1, M0)
            \tkzDefMidPoint(P1,P4) \tkzGetPoint{M1} \tkzDrawSegment[dual](O2, M1)
            \tkzDefMidPoint(P4,P6) \tkzGetPoint{M2} \tkzDrawSegment[dual](O3, M2)
            \tkzDefMidPoint(P6,P7) \tkzGetPoint{M3} \tkzDrawSegment[dual](O9, M3)
            \tkzDefMidPoint(P7,P8) \tkzGetPoint{M4} \tkzDrawSegment[dual](O8, M4)
            \tkzDefMidPoint(P3,P8) \tkzGetPoint{M5} \tkzDrawSegment[dual](O7, M5)
            \tkzDefMidPoint(P0,P3) \tkzGetPoint{M6} \tkzDrawSegment[dual](O6, M6)
            %\foreach \i in {0,...,6} {\tkzLabelPoints(M\i)}
            
            \tkzDefPointWith[K=1.2, linear](O1,M0) \tkzGetPoint{N0} 
            \tkzDefPointWith[K=1.2, linear](O2,M1) \tkzGetPoint{N1}
            \tkzDefPointWith[K=1.2, linear](O3,M2) \tkzGetPoint{N2}
            \tkzDefPointWith[K=1.2, linear](O9,M3) \tkzGetPoint{N3}
            \tkzDefPointWith[K=1.2, linear](O8,M4) \tkzGetPoint{N4}
            \tkzDefPointWith[K=1.5, linear](O7,M5) \tkzGetPoint{N5}
            \tkzDefPointWith[K=1.4, linear](O6,M6) \tkzGetPoint{N6}
            \foreach \i in {0,...,6} {\tkzDrawPoints[aux](N\i)}
            
            \tkzDefPointWith[K=1.07, linear](P5,P1) \tkzGetPoint{PP1}
            \tkzDefPointWith[K=1.07, linear](P5,P4) \tkzGetPoint{PP4}
            \tkzDefPointWith[K=1.08, linear](P5,P6) \tkzGetPoint{PP6}
            \tkzDefPointWith[K=1.07, linear](P2,P7) \tkzGetPoint{PP7}
            \tkzDefPointWith[K=1.07, linear](P2,P8) \tkzGetPoint{PP8}
            \tkzDefPointWith[K=1.07, linear](P2,P3) \tkzGetPoint{PP3}
            \tkzDefPointWith[K=1.03, linear](M3,P0) \tkzGetPoint{PP0}
            
            \tkzDrawSegments[aux](N0,PP1 PP1,N1 N1,PP4 PP4,N2 N2,PP6 PP6,N3 N3,PP7 PP7,N4 N4,PP8 PP8,N5 N5,PP3 PP3,N6 N6,PP0 PP0,N0)
            
        \end{tikzpicture}
    \caption{After cut-off}
    \end{subfigure}
    \begin{subfigure}[b]{0.35\textwidth}
        \centering
        \begin{tikzpicture}[scale=0.8]
            \coordinate (A1) at (0,0);
            \coordinate (A2) at (2,-0.7);
            \coordinate (A3) at (1.2,1);
            \coordinate (A4) at (-0.5,1.5);
            \draw[thick] (A1) node[left] {$\mathcal{M}$} -- (A2) -- (A3) -- cycle;
            \draw[thick] (A1) -- (A4) -- (A3);
            \begin{scope}[shift={(2,0.5)}]
                \coordinate (B1) at (0,0);
                \coordinate (B2) at (2,-0.7);
                \coordinate (B3) at (1.2,1);
                \coordinate (B4) at (-0.5,1.5);
                \draw[thick] (B2) -- (B3) -- (B4);
                \draw[gray]  (B1) -- (B3);
                \draw[gray]  (B1) -- (B2);
                \draw[gray]  (B1) -- (B4);
            \end{scope}
            \begin{scope}[shift={(4,1)}]
                \coordinate (C1) at (0,0);
                \coordinate (C2) at (2,-0.7);
                \coordinate (C3) at (1.2,1);
                \coordinate (C4) at (-0.5,1.5);
                \draw[thick] (C2) -- (C3) -- (C4);
                \draw[gray]  (C1) -- (C3);
                \draw[gray]  (C1) -- (C2);
                \draw[gray]  (C1) -- (C4);
            \end{scope}
            \draw[thick] (A4) -- (B4) -- (C4);
            \draw[thick] (A3) -- (B3) -- (C3);
            \draw[thick] (A2) -- (B2) -- (C2);
            \draw[gray]  (A1) -- (C1);
            \coordinate (O1) at (barycentric cs:A3=1,B3=1);
            \coordinate (O2) at (barycentric cs:A3=1,B3=1,A4=1,B4=1);
            \coordinate (O5) at (barycentric cs:A3=1,B3=1,A2=1,B2=1);
            \draw[orange, very thick] (O2) -- (O1) -- (O5);
            \coordinate (O3) at (barycentric cs:A1=1,A3=1,A4=1,B1=1,B3=1,B4=1);
            \coordinate (O4) at (barycentric cs:A1=1,A2=1,A3=1,B1=1,B2=1,B3=1);
            \draw[blue] (O2) -- (O3) -- (O4) -- (O5);
            \coordinate (OO1) at ([shift={(2,0.5)}]O1);
            \coordinate (OO2) at ([shift={(2,0.5)}]O2);
            \coordinate (OO3) at ([shift={(2,0.5)}]O3);
            \coordinate (OO4) at ([shift={(2,0.5)}]O4);
            \coordinate (OO5) at ([shift={(2,0.5)}]O5);
            \draw[very thick, orange] (OO2) -- (OO1) -- (OO5) node[right] {\textcolor{blue}{$\Tilde{\mathcal{M}}$}};
            \draw[blue] (OO2) -- (OO3) -- (OO4) -- (OO5);
            \draw[very thick, orange] (O2) -- (OO2);
            %\draw[very thick, blue] (O1) -- (OO1);
            \draw[very thick, orange] (O5) -- (OO5);
            \draw[blue] (O3) -- (OO3);
            \draw[blue] (O4) -- (OO4);
            \fill[gray,opacity=0.2] (A4) -- (A3) -- (C3) -- (C4);
            \fill[gray,opacity=0.2] (A3) -- (A2) -- (C2) -- (C3);
            \fill[orange,opacity=0.3] (OO2)--(O2)--(O1)--(O5)--(OO5)--(OO1);
        \end{tikzpicture}
        \caption{3D case}
    \end{subfigure}
    \caption{Illustration of cut-off boundary. Before the cut-off, the boundary of $\Tilde{\mathcal{M}}$ is not well-defined. To resolve the same boundary as $\mathcal{M}$, boundary dual cells are truncated and auxiliary elements are supplemented (shown in orange color). To be specific, in subfigure (c) four edges and one face are added in order to close this dual cell. Notice that these auxiliary edges and faces can be non-straight and non-flat.}
    \label{fig:illustraion_dual_boundary}
\end{figure}

\subsection{Discrete Maxwell Equations}
\subsubsection{Finite Integration Technique (FIT)}
We utilize FIT to discretize Maxwell's equations. This framework was originally proposed in \cite{weiland_1977} and can be treated as a generalization of Yee's FDTD method \cite{yee_1966}. FIT is established based on the integral form of Maxwell's equations:
\begin{subequations}
\begin{align}
    &\oint_{\partial A} \mathbf{E} \cdot d\mathbf{s} \ = - \iint_A \frac{\partial \mathbf{B}}{\partial t} \cdot d\mathbf{A}, \label{equ:maxwell_int_faraday}\\
    &\oint_{\partial A} \mathbf{H} \cdot d\mathbf{s} \ = \iint_A \left(\frac{\partial \mathbf{D}}{\partial t} + \mathbf{J}\right) \cdot d\mathbf{A}, \label{equ:maxwell_int_ampere}\\
    &\oint_{\partial V} \mathbf{B} \cdot d\mathbf{A} = 0, \label{equ:maxwell_int_gauss_B}\\
    &\oint_{\partial V} \mathbf{D} \cdot d\mathbf{A} = \iiint_V \rho dV. \label{equ:maxwell_int_gauss_D}
\end{align}
\end{subequations}
where $A, V$ stand for arbitrary surfaces and cells in the spatial domain. 

Given the mesh pair $(\mathcal{M}, \Tilde{\mathcal{M}})$, the discrete Maxwell system is described by applying the integral equations (\ref{equ:maxwell_int_faraday})-(\ref{equ:maxwell_int_gauss_D}) to the elements in $(\mathcal{M}, \Tilde{\mathcal{M}})$. We end up with
\begin{subequations}
\begin{align}
    &\sum_{j:L_j\in\partial A_i} \underbrace{\int_{L_j} \mathbf{E} \cdot d\mathbf{s}}_{:= e_j} = - \frac{\partial}{\partial t} \underbrace{\iint_{A_i} \mathbf{B} \cdot d\mathbf{A}}_{:= b_i},\ \ \ i = 1,...,N_A, \label{equ:maxwell_grid_faraday} \\
    &\sum_{j:\Tilde{L}_j\in\partial \Tilde{A}_i} \underbrace{\int_{\Tilde{L}_j} \mathbf{H} \cdot d\mathbf{s}}_{:= h_j} = \frac{\partial}{\partial t} \underbrace{\iint_{\Tilde{A}_i} \mathbf{D} \cdot d\mathbf{A}}_{:= d_i} + \underbrace{\iint_{\Tilde{A}_i} \mathbf{J} \cdot d\mathbf{A}}_{:= j_i}, \ \ \ i = 1,...,N_{\Tilde{A}}, \label{equ:maxwell_grid_ampere}\\
    &\sum_{j:A_j\in \partial V_i} \iint_{A_j} \mathbf{B} \cdot d\mathbf{A} = 0,\ \ \ i = 1,..., N_V,\label{equ:maxwell_grid_gauss_B}\\
    &\sum_{j:\Tilde{A}_j \in \partial\Tilde{V}_i}\iint_{\Tilde{A}_j} \mathbf{D} \cdot d\mathbf{A} = \underbrace{\iiint_{\Tilde{V}_i} \rho dV}_{:= q_i},\ \ \ i = 1,...,N_{\Tilde{V}}. \label{equ:maxwell_grid_gauss_D}
\end{align}
\end{subequations}
where $i, j$ are indices for elements in the meshes.

The integral quantities are the unknowns to be solved. As is defined in (\ref{equ:maxwell_grid_faraday})-(\ref{equ:maxwell_grid_gauss_D}) by the underbraces, these scalar quantities are stacked into vectors:
\begin{equation} \label{equ:fit_scale_vector}
    \mathbf{e} := (e_i)_{i=1}^{N_L},\ \ \mathbf{b} := (b_i)_{i=1}^{N_A}, \ \ \mathbf{h} := (h_i)_{i=1}^{N_{\Tilde{L}}}, \ \ \mathbf{d} := (d_i)_{i=1}^{N_{\Tilde{A}}}, \ \ \mathbf{j} := (j_i)_{i=1}^{N_{\Tilde{A}}}, \ \ \mathbf{q} := (q_i)_{i=1}^{N_{\Tilde{V}}}.
\end{equation}

\begin{remark}
    In an implementation, it is always convenient to index a pair of corresponding primal and dual elements with the same number. For instance, a primal face $A_k$ is penetrated by the dual edge $\Tilde{L}_k$. In the following discussion, we stick to this convention, which will simplify our notation.
\end{remark}

The material laws (\ref{equ:material_law}) need to be reformulated within this framework. The relations between scalar vectors, in the form of $\mathbf{b} = \mathbb{M}_\mu \mathbf{h}$ and $\mathbf{d} = \mathbb{M}_\varepsilon \mathbf{e}$, are to be derived. In the simplest case where permittivity $\mu$ and permeability $\varepsilon$ are homogeneous in the domain, and the orthogonality of the pair ($\mathcal{M}, \Tilde{\mathcal{M}}$) is ensured, the material matrices are diagonal with entries 

\begin{equation*}
    (\mathbb{M}_\mu)_{i,i} = \frac{\mu|A_i|}{|\Tilde{L}_i|}, \ \ \ \ \ (\mathbb{M}_\varepsilon)_{i,i} = \frac{\varepsilon |\Tilde{A}_i|}{|L_i|},
\end{equation*}
where $|\cdot|$ denotes taking length or area. We would like to remark that the approximation error is introduced due to the implicit assumption that vector fields are piecewise constant, see the analysis in \cite{Marrone_2001}.

With the aid of incidence matrices defined in the preceding section and given the discrete material law, (\ref{equ:maxwell_grid_faraday})-(\ref{equ:maxwell_grid_gauss_D}) can be recast into a set of algebraic equations:
\begin{center}
\vspace{-0.5cm}
\begin{minipage}{0.3\textwidth}
\begin{align*}
    \partial_t \mathbf{B} + \nabla \times \mathbf{E} &= 0, \\
    \partial_t \mathbf{D} - \nabla \times \mathbf{H} &= -\mathbf{J}, \\
    \nabla \cdot \mathbf{B} &= 0,  \\
    \nabla \cdot \mathbf{D} &= \rho, \\
    \mathbf{H} &= \mu^{-1} \mathbf{B}, \\
    \mathbf{D} &= \varepsilon \mathbf{E}. 
\end{align*}
\end{minipage}
\begin{minipage}{0.1\textwidth}
\centering
\begin{tikzpicture}
\draw[thick, -{to}] (0,0) -- node[above]{$(\mathcal{M}, \Tilde{\mathcal{M}})$} (1.5,0);
\end{tikzpicture}
\end{minipage}
\begin{minipage}{0.3\textwidth}
\begin{subequations}
\begin{align}
    \dot{\mathbf{b}} + \mathbb{C}\mathbf{e} &= \mathbf{0} , \label{equ:alg_faraday}\\
    \dot{\mathbf{d}} - \Tilde{\mathbb{C}}\mathbf{h} &= - \mathbf{j}, \label{equ:alg_empere}\\
    \mathbb{D}\mathbf{b} &= \mathbf{0},  \label{equ:alg_gauss_b}\\
    \Tilde{\mathbb{D}}\mathbf{d} &= \mathbf{q},  \label{equ:alg_gauss_d}\\
    \mathbf{h} &= \mathbb{M}_\mu^{-1} \mathbf{b}, \label{equ:alg_material_magnetic}\\
    \mathbf{d} &= \mathbb{M}_{\varepsilon} \mathbf{e}, \label{equ:alg_material_electric} 
\end{align}
\end{subequations}
\end{minipage}
\end{center}
where the topping dot $\cdot$ stands for taking the time derivative.

At this point, we would like to emphasize the importance of the primal-dual staggered meshes: the material laws can be included in a rather simple way. For magnetic Gauss's law $\mathbf{D} = \varepsilon \mathbf{E}$, for instance, the $\mathbf{D}$-field is represented by a collection of face integrals $ (d_i)_{i}$ while $\mathbf{E}$-field is represented by a collection of edge integrals $ (e_i)_{i}$. The primal-dual meshes allow us to arrange them in a staggered way -- edges penetrate faces -- such that $\mathbf{D} = \varepsilon \mathbf{E}$ can be approximated by $\mathbf{d} = \mathbb{M}_{\varepsilon}\mathbf{e}$ in a local fashion, i.e. $\mathbb{M}_{\varepsilon}$ is diagonal. A more schematic illustration involves the language of differential forms and discrete Hodge operators, see \cite{bossavit1999, teixeira_1999, hip_1999}. 

This transformation does not introduce approximations \emph{except for} the discrete material laws. The essence of FIT lies in that the complexity of continuous electric and magnetic field quantities
is reduced to a finite number of well-defined discrete unknowns \citep{weiland_2003}. Also, this discrete version of Maxwell's equations (\ref{equ:alg_faraday})-(\ref{equ:alg_material_electric}) are topological in the sense that they are invariant under different coordinate systems.

\subsubsection{Discrete Boundary Conditions}
The electromagnetic boundary $\Gamma_C, \Gamma_I$ is resolved by the primal mesh $\mathcal{M}$. As is mentioned in Section \ref{sec:BC}, a boundary scalar potential $\varphi$ can be introduced due to the vanishing surface curl of $\mathbf{E}$-field. It holds in the discrete level as well. We assign each primal vertex $P_i \in \partial\Omega$ a scalar value $\varphi_i$. Therefore, the boundary conditions (see Section \ref{sec:BC}) are discretized in the following way:
\begin{center}
    \vspace{-0.5cm}
    \begin{minipage}{0.3\textwidth}
    \begin{align*}
    \text{curl} \mathbf{E} \cdot \mathbf{n} = 0\ \ &\text{on} \ \  \Gamma_I,  \\
    \text{curl} \mathbf{H} \cdot \mathbf{n} = 0\ \  &\text{on} \ \  \Gamma_I, \\
    \varphi = \varphi^\pm(t)\ \ &\text{on} \ \ \Gamma_C^\pm.
    \end{align*}
    \end{minipage}
    \begin{minipage}{0.1\textwidth}
    \centering
    \begin{tikzpicture}
    \draw[thick, -{to}] (0,0) -- node[above]{$(\mathcal{M}, \Tilde{\mathcal{M}})$} (1.5,0);
    \end{tikzpicture}
    \end{minipage}
    \begin{minipage}{0.4\textwidth}
        \begin{subequations}
            \begin{align}
            e_i = (\mathbb{G}\bm{\varphi})_i,\ \ &\forall i : L_i \subset \partial\Omega, \label{equ:bc_2}\\
            (\Tilde{\mathbb{C}} \bm{h})_i = 0\ \ &\forall i : \Tilde{A}_i \subset \Gamma_I,\label{equ:bc_3} \\
            \varphi_i = \varphi^\pm(t), \ \ &\forall i : P_i \subset \Gamma_C^\pm. \label{equ:bc_1}
            \end{align}
        \end{subequations}
    \end{minipage}
\end{center}

\subsubsection{Reformulation} \label{sec:reform_discrete}
In Section \ref{sec:reform_continuous}, we propose a stabilization of the Maxwell system in the non-conducting domain $\Omega_N$ by introducing a Lagrange multiplier. In the semi-discrete level, the equations to be solved in $\Omega_N$ are
\begin{subequations}
    \begin{align}
        \dot{\mathbf{b}} + \mathbb{C}\mathbf{e} &= \mathbf{0} ,\\
        \dot{\mathbf{d}} - \Tilde{\mathbb{C}}\mathbf{h} + \colorbox{orange!20}{$\mathbb{H} \mathbb{G} \bm{\psi}$}&= \mathbf{0},\\
        \Tilde{\mathbb{D}}\mathbf{d} &= \mathbf{0} \label{equ:discrete_zero_div}, 
    \end{align} 
\end{subequations}

where $\bm{\psi} = (\psi_i)_i$ denotes unknowns assigned to each primal vertex in $\Omega_N$ and the matrix $\mathbb{H}_{i,i} = \frac{|\Tilde{A}_i|}{|L_i|}$ transforms primal edge integrals to dual face fluxes\footnote{$\mathbb{H}$ functions as a discrete Hodge operator.}. To incorporate the zero Dirichlet BC, we limit the unknowns $(\psi_i)_{i=1}^{N^{N,\circ}_P}$ to primal vertices in $\Omega_N^\circ$.

\subsubsection{Remark: Balance of Equations and Unknowns}

We can heuristically examine the well-posedness of the (semi-)discrete Maxwell system by checking whether the numbers of unknowns (also called degrees of freedom (D.o.F.)) and equations coincide. Before counting, we make a meticulous classification for mesh elements according to their locations and summarize the notation for the sake of clarification (see Tab. \ref{tab:def_size_var}).
\begin{center}
\vspace{-0.5cm}
\begin{minipage}[t]{0.4\textwidth}
    \begin{align*}
        &\#\  \text{primal cell}\ \  N_V \\
        &\#\  \text{primal edge}\ \  N_L := \underbrace{N^C_L + N^I_L}_{=N^\partial_L} + N^\circ_L  \\
        &\#\  \text{primal face}\ \  N_A := \underbrace{N_A^C + N^I_A}_{=N^\partial_A} + N^\circ_A  \\
        &\#\  \text{primal vertex}\ \  N_P := \underbrace{N_P^C + N^I_P}_{=N^\partial_P} + N^\circ_P
    \end{align*}
\end{minipage}
\begin{minipage}[t]{0.4\textwidth}
    \begin{align*}
        &\#\  \text{dual cell}\ \  N_{\Tilde{V}} := N_P \\
        &\#\  \text{dual edge}\ \  N_{\Tilde{L}} := \underbrace{N^\partial_{\Tilde{L}}}_{=N^\partial_L} + \underbrace{N^\circ_{\Tilde{L}}}_{=N_A} \\
        &\#\  \text{dual face}\ \  N_{\Tilde{A}} := \underbrace{N^\partial_{\Tilde{A}}}_{=N^\partial_P} + \underbrace{N^\circ_{\Tilde{A}}}_{=N_L}
    \end{align*}
\end{minipage}   
\end{center}


where the superscript indicates the locations where the elements lie. The equations $N^\partial_{\Tilde{L}} = N^\partial_L, N^\partial_{\Tilde{A}} = N^\partial_P$ reveal the bijective relation between the boundary primal elements and auxiliary elements, as can be checked easily by inspecting Fig. \ref{fig:illustraion_dual_boundary}.

\begin{table}[]
    \centering
\begin{tabular}{c c c}
     \hline
     D.o.F.  & Meaning  & Size \\
     \hline
     $\mathbf{e}$ & line integrals of $\mathbf{E}$-field at primal edges $L$& $N_L$ \\
     $\bm{\varphi}$ & electric potentials at primal vertices $P$ on $\partial\Omega$ & $N_P^\partial$ \\
     $\mathbf{b}$ & surface integrals of $\mathbf{B}$-field at primal faces $A$ & $N_A$ \\
     $\mathbf{h}$ & line integrals of $\mathbf{H}$-field at dual edges $\Tilde{L}$ & $N_{\Tilde{L}}$ \\
     $\mathbf{d}$ & surface integrals of $\mathbf{D}$-field at dual faces $\Tilde{A}$ & $N_{\Tilde{A}}$ \\
     $\bm{\psi}$ & Lagrange multiplier at primal vertices $P$ in $\Omega_N^\circ$ & $N^{N,\circ}_P$\\ 
     \hline
\end{tabular}
    \caption{Definitions and sizes of all vectors of degrees of freedom.}
    \label{tab:def_size_var}
\end{table}

Next, we collect all the algebraic equations derived from the Maxwell system and the boundary conditions: 
\begin{align*}
    \text{discrete Faraday law (\ref{equ:alg_faraday})} \ \ &\longrightarrow\ \  N_A \ \ \text{equations} \\
    \text{discrete Ampere law (\ref{equ:alg_empere})} \ \ &\longrightarrow\ \  N_{\Tilde{A}} \ \ \text{equations} \\
    \text{discrete material laws (\ref{equ:alg_material_magnetic})(\ref{equ:alg_material_electric})} \ \ &\longrightarrow\ \  N_A + N_L \ \ \text{equations} \\
    \text{boundary condition (\ref{equ:bc_1})} \ \ &\longrightarrow\ \  N_P^C \ \ \text{equations} \\
    \text{boundary condition (\ref{equ:bc_2})} \ \ &\longrightarrow\ \  N_L^\partial \ \ \text{equations} \\
    \text{boundary condition (\ref{equ:bc_3})} \ \ &\longrightarrow\ \  N_{\Tilde{A}}^I \ \ \text{equations}. \\
    \text{vanishing divergence constraint (\ref{equ:discrete_zero_div})} \ \ &\longrightarrow\ \  N_P^{N,\circ} \ \ \text{equations}. \\
\end{align*}
Comparing the numbers of D.o.F in Tab. \ref{tab:def_size_var} and of the equations we collect, we show that they are equal:
\begin{align*}
    \#\text{ of unknowns} &= \colorbox{violet!20}{$N_L$} + \colorbox{blue!20}{$N_A$} + \colorbox{gray!40}{$N_{\Tilde{L}}$} + \colorbox{orange!20}{$N_{\Tilde{A}}$} + \colorbox{green!20}{$N_P^\partial$} + \colorbox{yellow!40}{$N_P^{N,\circ}$}, \\
    \#\text{ of equations} &= \colorbox{blue!20}{$N_A$} + \colorbox{orange!20}{$N_{\Tilde{A}}$} + \colorbox{gray!40}{$N_A$} + \colorbox{violet!20}{$N_L$} + \colorbox{gray!40}{$N_L^\partial$} + \colorbox{green!20}{$N_P^C + N_P^I$}+ \colorbox{yellow!40}{$N_P^{N,\circ}$},
\end{align*}
where the terms with the same color are equal.

However, the matching of numbers of unknowns and equations does not necessarily result in a valid linear system since the equations might be linearly dependent. We will see later in Section \ref{sec:inapp_bc} that inappropriate BCs could cause the singularity of the linear system as $\lambda \rightarrow 0$. 

\subsection{Discrete Euler Equations}
We employ the finite volume method (FVM) to discretize the Euler system. As a classical framework for solving conservation laws and hyperbolic systems, FVM is derived from the integral form of the equations in each cell. It is the cell average of quantities that evolves at each time step, based on the \emph{numerical flux} through the cell boundary. The construction of the numerical flux, which serves to approximate the real flux, is the essence of constructing FVM schemes. Due to the convection nature of fluid dynamics, the numerical fluxes are supposed to respect the convection direction, that is, an \emph{upwind scheme} is preferable. To this end, people resort to the approximated solution of \emph{Riemann problems}. The method is briefly illustrated in the following. For detailed information, see the textbook \cite{leveque_2002}.

The Euler equations (\ref{equ:euler_}) can be generalized into the form of conservation law with source terms:
\begin{equation} \label{equ:euler_conservation}
    \partial_t \mathbf{U} + \nabla \cdot \mathbf{f}(\mathbf{U}) = \mathbf{RHS},
\end{equation}
where $\mathbf{U} \in L^2(\Omega \times [0,T], \mathbb{R}^m)$ stands for $m$ conservative variable, $\mathbf{f}(\mathbf{U}) \in L^2(\Omega \times  [0,T], \mathbb{R}^m)$ is the flux density, and $\mathbf{RHS} \in L^2(\Omega \times  [0,T], \mathbb{R}^m)$ is the source term. 

To obtain the semi-discretization, we first integrate (\ref{equ:euler_conservation}) over a cell $V_i$ 
\begin{equation} \label{equ:euler_grid} 
    \dot{\overline{\mathbf{U}}}_i + \frac{1}{|V_i|}\sum_{j:A_j\in\partial V_i} |A_j|\underbrace{\frac{1}{|A_j|}\iint_{A_j}\mathbf{f}(\mathbf{U})\cdot \mathbf{n}_j \text{d}A}_{:= \overline{\mathbf{f}}_j \approx \mathbf{f}^\text{num}_j} = \underbrace{\frac{1}{|V_i|}\iiint_{V_i} \mathbf{RHS} \text{d}V}_{:= \overline{\mathbf{RHS}}_i}
\end{equation}
where $\overline{\mathbf{U}}_i := \iiint_{V_i} \mathbf{U} \text{d}V / |V_i| \in L^2([0,T],\mathbb{R}^m)$ is the cell average of $\mathbf{U}$ and $\mathbf{n}_j$ is the outer normal vector of face $A_j$ with respect to the cell $V_i$. We approximate the flux $\overline{\mathbf{f}}_j$ in (\ref{equ:euler_grid}) by a numerical flux $\mathbf{f}^\text{num}_j := \mathbf{f}^\text{num}\left(\overline{\mathbf{U}}_i, \overline{\mathbf{U}}_{k(i,j)}, \mathbf{n}_j\right)$, where $k(i,j)$ returns the index of the adjacent cell that shares $A_j$ with cell $V_i$. Classical numerical fluxes include Lax-Friedrich flux, Rusanov flux, and Engquist-Osher flux, see \cite[][p. 44-46]{mishra_2019}. Finally, we end up with the semi-discretized equation:
\begin{equation}
    \dot{\overline{\mathbf{U}}}_i + \frac{1}{|V_i|}\sum_{j:A_j\in\partial V_i} |A_j| \mathbf{f}^\text{num}\left(\overline{\mathbf{U}}_i, \overline{\mathbf{U}}_{k(i,j)}, \mathbf{n}_j\right) = \overline{\mathbf{RHS}}_i.
    \label{equ:fvm}
\end{equation}
The Rusanov flux in multi-dimensions on face $A_j$ writes
\begin{equation} \label{equ:rusanov-flux-3d}
    \mathbf{f}^\text{num}\left(\overline{\mathbf{U}}_L, \overline{\mathbf{U}}_R, \mathbf{n}\right) = \frac{1}{2}\left[\mathbf{f}(\overline{\mathbf{U}}_L)\cdot\mathbf{n} + \mathbf{f}(\overline{\mathbf{U}}_R)\cdot\mathbf{n}\right] - \frac{1}{2}\overline{s}\left(\overline{\mathbf{U}}_R - \overline{\mathbf{U}}_L\right),  
\end{equation}
where $\overline{s} = \text{max}(s(\overline{\mathbf{U}}_L), s(\overline{\mathbf{U}}_R))$ with $s(\mathbf{U}) := |\mathbf{u}\cdot\mathbf{n}| + \sqrt{\gamma p/\rho}$ representing the largest wave speed. 

We would like to emphasize that the Euler system is discretized on $\mathcal{M}'$ due to the fact that 1) the electric current is connected to the momenta of charged particles by (\ref{equ:maxwell_euler_coupling}); 2) the electric current is discretized on dual faces by (\ref{equ:maxwell_grid_ampere}).

To rewrite (\ref{equ:fvm}) into a matrix form, by abuse of notation we stack all the cell average $(\overline{\mathbf{U}}_i)_i$ into a matrix $\mathbf{U} \in \mathbb{R}^{N_{\Tilde{V}}^P \times m}$ with $\mathbf{U}_{i,:} = \overline{\mathbf{U}}_i$. Meanwhile, we denote by $\mathbf{F} \in \mathbb{R}^{N_{\Tilde{A}}^P \times m}$ the collection of the (total) numerical fluxes, i.e. $\mathbf{F}_{i,:} = \mathbf{f}^\text{num}_i$. In the same way, we denote by $\mathbf{RHS}\in \mathbb{R}^{N_{\Tilde{V}}^P \times m}$ the collection of $\overline{\mathbf{RHS}}_i$. Besides, we define the diagonal matrix $\mathbb{\Tilde{V}} \in \mathbb{R}^{N_{\Tilde{V}}^P \times N_{\Tilde{V}}^P}$ and $\mathbb{\Tilde{A}}\in \mathbb{R}^{N_{\Tilde{A}}^P \times N_{\Tilde{A}}^P}$ with $\mathbb{\Tilde{A}}_{i,i} = |\Tilde{A}_i|$. Making use of the incidence matrices, we end up with
\begin{equation*}
    \dot{\mathbf{U}} + \mathbb{\Tilde{V}}^{-1}\mathbb{\Tilde{D}}\mathbb{\Tilde{A}}\mathbf{F}(\mathbf{U})  = \mathbf{RHS}(\mathbf{U},\mathbf{d},\mathbf{b}),
\end{equation*}
where the dependence of $\mathbf{RHS}$ on $\mathbf{d}, \mathbf{b}$ is implied by (\ref{equ:euler_rescaled}) and will be elaborated below.

\subsubsection{Reconstruction of Lorentz Force}
Since the electromagnetic fields are represented by integrals on edges and faces, we need to reconstruct their vector components for the computation of Lorentz force (and Joule heating) inside each dual cell.    

The problem is twofold:
\begin{itemize}
    \item[-] given the fluxes at faces of a cell, reconstruct the vector field inside the cell;
    \item[-] given the integrals along the edges of a cell, reconstruct the vector field inside the cell. 
\end{itemize}
We adopt the principle of least square fitting and reconstruct a \emph{constant} vector field inside each cell. For a cell $\Tilde{V}$ with $k$ faces with areas $\{A_i\}_{i=1}^k$, normal vectors $\{\mathbf{n}_i\}_{i=1}^k$ and fluxes $\{f_i\}_{i=1}^k$, a constant vector field $\mathbf{v}$ satisfying 
\begin{equation*}
    \mathbf{v} = \argmin_{v\in \mathbb{R}^3} \sum_{i=1}^k(A_i\mathbf{v} \cdot \mathbf{n}_i - f_i)^2.   
\end{equation*} can be computed through
\begin{equation*}
    \mathbf{v} = (\mathbb{K}^T\mathbb{K})^{-1}\mathbb{K}^T\mathbf{f},
\end{equation*}
where
\begin{equation*}
    \mathbb{K} = [A_1\mathbf{n}_1, A_2\mathbf{n}_2, \cdots, A_k\mathbf{n}_k]^T,\ \ \ \mathbf{f} = [f_1, f_2, \cdots, f_k]^T,
\end{equation*}
and each vector in $\mathbb{R}^3$ is treated as a column vector. The construction based on the integral quantities on edges can be done similarly. Assembling the local constructions for each dual cell, the global construction can be written as 
\begin{equation}
    \mathbf{E} = \Tilde{\mathbb{R}}_E\mathbf{d},
    \ \ \ \ 
    \mathbf{B} = \Tilde{\mathbb{R}}_B\mathbf{b}, \label{equ:reconstruction}
\end{equation}
where $\mathbf{d}, \mathbf{b}$ are stacked unknowns, see Tab. \ref{tab:def_size_var}; $\mathbf{E} := (\mathbf{E}_i)_{i=1}^{N_{\Tilde{V}}}$ and $\mathbf{B} := (\mathbf{B}_i)_{i=1}^{N_{\Tilde{V}}}$ are $N_{\Tilde{V}} \times 3$ matrices stacking the reconstructed $\mathbf{E}$-fields and $\mathbf{B}$-fields at each $\Tilde{V}$; $\Tilde{\mathbb{R}}_E$ and $\Tilde{\mathbb{R}}_B$ are thus rank-3 tensors.

The problem of the reconstruction of vector fields on unstructured meshes is a widely studied topic. Apart from the least-square method, other methods include Perot's method \citep{perot_2000}, finite-element-based methods, etc., which potentially can achieve higher-order accuracy. See \cite[][sec. 3.4.4]{fuchs_2021} and the references therein.  

\subsubsection{Discrete Boundary Conditions}
The BCs for the Euler system (see Section \ref{sec:BC}) are implemented by the approach of ghost cells \cite[][ch. 7]{leveque_2007}, i.e. thinking of extending the domain by a few additional cells and prescribing the variables. In our case, the ghost cells at the open boundary at $\Gamma_C$ are set to have equal values as the interior ones that are adjacent. It is equivalent to enforcing the numerical fluxes
\begin{equation*}
    \mathbf{F}_i = {\mathbf{f}^\text{num}}(\mathbf{U}_j, \mathbf{U}_j, \mathbf{n}_i), \ \ \forall i: \Tilde{A}_i \subset \Gamma_C,
\end{equation*}
where $j$ refers to the index of the cell adjacent to the boundary face $\Tilde{A}_i$ and is unique. For the reflective wall $\Gamma_W$, the momentum of a ghost cell is reversed with respect to its adjacent one while keeping the other quantities unchanged. Therefore, the numerical fluxes are 
\begin{equation*}
    \mathbf{F}_i = \mathbf{f}^\text{num}(\mathbf{U}_j, \hat{\mathbf{U}}_j, \mathbf{n}_i), \ \ \forall i: \Tilde{A}_i \subset \Gamma_W,
\end{equation*}
where the value of the ghost cell $\hat{\mathbf{U}} = [n, n\mathbf{u} - 2(\mathbf{n}\cdot\mathbf{u})\mathbf{n}, ne]^T$ reverses the normal velocity of $\mathbf{U} = [n, n\mathbf{u}, ne]^T$. 


\subsection{Summary: Spatially Semi-discrete Model}
We collect all the equations and BCs presented above and make a summary for the spatially semi-discrete Maxwell-Euler system based on the FIT-FVM framework:
\begin{subequations}
    \begin{align}
        [\dot{\mathbf{b}} + \mathbb{C}\mathbf{e} = \mathbf{0}]_i, \ \ &\forall i: A_i \subset \Omega, \\
        [\dot{\mathbf{d}} - \Tilde{\mathbb{C}}\mathbf{h} = - \Sigma_{\ast} q_*\bm{f}_{\ast}^{n}]_i, \ \ &\forall i: \Tilde{A}_i \subset \Omega_P,\\
        [\dot{\mathbf{d}} - \Tilde{\mathbb{C}}\mathbf{h} + \mathbb{H} \mathbb{G} \bm{\psi} = \mathbf{0}]_i, \ \ &\forall i: \Tilde{A}_i \subset \Omega_N,\\
        [\Tilde{\mathbb{D}}\mathbf{d} = \mathbf{0}]_i,\ \ &\forall i: \Tilde{V}_i \subset \Omega_N, \\
        [\dot{\mathbf{U}}_\ast + \mathbb{\Tilde{V}}^{-1}\mathbb{\Tilde{D}}\mathbb{\Tilde{A}}\mathbf{F}_\ast = \mathbf{RHS}_\ast]_i,\ \ &\forall i: \Tilde{V}_i \subset \Omega_P, \\
        [\mathbf{d} = \mathbb{M}_\varepsilon\mathbf{e}]_i,\ \ &\forall i:L_i \subset \Omega,\\
        [\mathbf{h} = \mathbb{M}_\mu^{-1}\mathbf{b}]_i, \ \ &\forall i:A_i \subset \Omega,
    \end{align}
    \begin{comment}
        \vspace{-1cm}
        \begin{align}
            \hspace{1.6cm}\mathbf{j}_i =
            \begin{cases}
             \Sigma_{\ast} q_*\bm{f}_{\ast,i}^{n},&\forall i: \Tilde{A}_i \subset \Omega_P, \\
            0,&\forall i: \Tilde{A}_i \subset \Omega_N,
            \end{cases}
        \end{align}
    \end{comment}
where $\ast \in \{\text{electron}, \text{ion}, \dots\}$ and $\bm{f}^n$ denotes the mass flux. By $[\dots]_i$ we mean taking the $i$-th component of both sides of the equation. We have the following BCs:
    \begin{align}
    \varphi_i = \varphi(P_i, t), \ \ &\forall i : P_i \subset \Gamma_C, \\
    e_i = (\mathbb{G}\bm{\varphi})_i,\ \ &\forall i : L_i \subset \partial\Omega, \\
    (\Tilde{\mathbb{C}} \bm{h})_i = 0,\ \ &\forall i : \Tilde{A}_i \subset \Gamma_I, \label{equ:bc_zero_curl_h} \\
    \mathbf{F}_{\ast,i} = \mathbf{f}^\text{num}(\mathbf{U}_{\ast,j}, \mathbf{U}_{\ast,j}, \mathbf{n}_i), \ \ &\forall i: \Tilde{A}_i \subset \Gamma_C, \\
    \mathbf{F}_{\ast,i} = \mathbf{f}^\text{num}(\mathbf{U}_{\ast,j}, \hat{\mathbf{U}}_{\ast,j}, \mathbf{n}_i), \ \ &\forall i: \Tilde{A}_i \subset \Gamma_W.
    \end{align}
\end{subequations}
We would like to stress again that in our FIT-FVM framework Faraday's law is discretized on $\mathcal{M}$ while Amp\`{e}re's law is discretized on $\mathcal{M}'$ for a simple approximation of material laws. By arranging the Euler system on $\mathcal{M}'$, the connection between electric currents and fluid momenta is naturally established in the discrete level since they are defined on the same locations.    


\section{Full Discretization}
\subsection{Motivation: Reduction to 1D Discretization}
Our work is an extension of the 1D scheme proposed in \cite{degond_2012} towards three dimensions. Therefore, it is supposed to be compatible with the original 1D scheme when reduced to one dimension. This perspective helps to understand how the 3D scheme stems from the 1D one, which is not trivial. For the sake of presentation, we discuss their one-fluid model where ions are assumed immobile and only the motion of electrons is considered.  

\subsubsection{Projection to One Dimension} \label{sec:projection_to_1d}
Consider a mesh pair $(\mathcal{M}, \mathcal{M}')$ that are constructed by 2D extrusion along $z$-axis and are unbounded along transverse directions. On assuming the transverse invariance and rotational symmetry, we can ``project'' all the D.o.F. onto the $z$-axis. The idea is sketched in in Fig. \ref{fig:1d_reduction}.

\begin{figure}
    \centering
    \begin{tikzpicture}[scale=0.4]
        \def\primalstyle{thick}
        \def\dualstyle{thick}
        \coordinate (P0) at (0cm, 0cm);
        \foreach \i in {1,2,...,6}
        {
        \coordinate (P\i) at ({60*\i-30}:2cm);
        \draw[\primalstyle] (P0) -- (P\i);
        }
        \draw[\primalstyle] (P1) -- (P2) node[left=5mm]{\Large $\mathcal{M}$} -- (P3) -- (P4) -- (P5) -- (P6) -- cycle;
        
        \draw[very thick, -stealth] (-7.5,-1.05) -- (10,1.4) node[right] {$z$-axis};
        \begin{scope}[shift={(5cm,0.7
        cm)}]
            \coordinate (PP0) at (0cm, 0cm);
            \foreach \i in {1,2,...,6}
            {
            \coordinate (PP\i) at ({60*\i-30}:2cm);
            \draw[gray] (PP0) -- (PP\i);
            }
        \end{scope}

        
        \draw[\primalstyle] (PP1) -- (PP2);
        \draw[gray] (PP2) -- (PP3);
        \draw[gray] (PP3) -- (PP4);
        \draw[gray] (PP4) -- (PP5);
        \draw[\primalstyle] (PP5) -- (PP6);
        \draw[\primalstyle] (PP6) -- (PP1);
        
        \draw[gray] (P0) -- (PP0);
        \draw[\primalstyle] (P1) -- (PP1);
        \draw[\primalstyle] (P2) -- (PP2);
        \draw[gray] (P3) -- (PP3);
        \draw[gray] (P4) -- (PP4);
        \draw[\primalstyle] (P5) -- (PP5);
        \draw[\primalstyle] (P6) -- (PP6);
        
        \foreach \i in {1,2,...,6}
        {
        \coordinate (D\i) at ({60*\i-60}:{2./1.737});
        }
        \draw[dashed, blue] (D1) -- (D2) -- (D3) -- (D4) -- (D5) -- (D6) -- cycle;
        \begin{scope}[shift={(2.5,0.35)}]
            \foreach \i in {1,2,...,6}
            {
            \coordinate (DD\i) at ({60*\i-60}:{2./1.737});
            }
        \end{scope}
        \draw[blue] (DD1) -- (DD2) -- (DD3) -- (DD4) -- (DD5) -- (DD6) -- cycle;
        \draw[blue] (D1) -- (DD1);
        \draw[blue] (D2) -- (DD2);
        \draw[blue] (D3) -- (DD3);
        \draw[blue] (D4) -- (DD4);
        \draw[blue] (D5) -- (DD5);
        \draw[blue] (D6) -- (DD6);
        
        \begin{scope}[shift={(-2.5,-0.35)}]
            \foreach \i in {1,2,...,6}
            {
            \coordinate (DDD\i) at ({60*\i-60}:{2./1.737});
            }
        \end{scope}
        
        
        \begin{scope}[shift={(5cm,0.7cm)}]
            \draw[fill = gray!60, opacity=0.4] (-3,5) -- (3,2) -- (3,-5)  -- (-3,-2) -- cycle; 
            \draw[thick, violet] (-3,5) -- (3,2) -- (3,-5) -- (-3,-2) -- cycle; 
            \draw[fill=violet] (0,0) circle (0.2) ;
            \node[below] (n) at (3,-5) {\textcolor{black}{$z_{k+1}$}};
        \end{scope}
        \begin{scope}[shift={(2.5,0.35)}]
            \draw[fill = gray!40, opacity=0.4] (-3,5) -- (3,2) -- (3,-5) -- (-3,-2) -- cycle; 
            \draw[thick, red] (-3,5) -- (3,2) -- (3,-5) -- (-3,-2) -- cycle;
            \draw[fill=red] (0,0) circle (0.2) ;
            \node[below] (n) at (3,-5) {\textcolor{black}{$z_{k+1/2}$}};
        \end{scope}
        \draw[fill = gray!20, opacity=0.4] (-3,5) -- (3,2) -- (3,-5) -- (-3,-2) -- cycle; 
        \node[below] (n) at (3,-5) {\textcolor{black}{$z_{k}$}};
        \draw[thick, brown] (-3,5) -- (3,2) -- (3,-5) -- (-3,-2) -- cycle;
        \draw[fill=brown] (0,0) circle (0.2) ;
        \draw[blue, ultra thick] (DDD1) -- (DDD2) -- (DDD3) node[left=3mm]{\textcolor{blue}{\Large $\Tilde{\mathcal{M}}$}} -- (DDD4) -- (DDD5) -- (DDD6) -- cycle;
        \draw[blue, ultra thick] (D1) -- (DDD1);
        \draw[blue, ultra thick] (D2) -- (DDD2);
        \draw[blue, ultra thick] (D3) -- (DDD3);
        \draw[blue] (D4) -- (DDD4);
        \draw[blue] (D5) -- (DDD5);
        \draw[blue, ultra thick] (D6) -- (DDD6);
        \fill[blue!50, opacity=0.2] (D1) -- (D2) -- (D3) -- (D4) -- (D5) -- (D6);
         \begin{scope}[shift={(-2.5cm,-0.35
        cm)}]
            \draw[fill = gray!10, opacity=0.4] (-3,5) -- (3,2) -- (3,-5) -- (-3,-2) -- cycle; 
            \draw[thick, orange!50] (-3,5) -- (3,2) -- (3,-5) -- (-3,-2) -- cycle; 
            \draw[fill=orange!50] (0,0) circle (0.2) ;
            \node[below] (n) at (3,-5) {\textcolor{black}{$z_{k-1/2}$}};
        \end{scope}
    \end{tikzpicture}
    \caption{3D discretization to 1D. On the assumption of transverse invariance, we can reduce all the D.o.F. lying in the perpendicular plane $z=z_k$ to the vertex at $z=z_k$. For instance, an edge orthogonal to the $z$-axis is projected to a vertex while a parallel edge to the $z$-axis is projected to an edge.}
    \label{fig:1d_reduction}
\end{figure}

\begin{remark}
    The 1D reduction of FIT-FVM discretization can be interpreted in the sense of finite difference. 
\end{remark}

In \cite{degond_2012}, the author investigates a 1D Maxwell-Euler system by assuming vanishing traverse derivatives. For further simplicity, a transverse mode is considered, i.e. $u_y, E_y, B_x$, and $B_z$ are set to zero.  The 1D reduced one-fluid Maxwell-Euler system and its quasi-neutral limit are 

\vspace{-0.3cm}
\begin{minipage}{0.6\textwidth}
    \begin{align*}
        \partial_t n + \partial_z(nu_z) &= 0, \\
        \varepsilon^2[\partial_t(nu_x) + \partial_z(nu_zu_x)] &= - n(E_x - u_zB_y), \\
        \varepsilon^2[\partial_t(nu_z) + \partial_z(nu_z^2)] + \partial_z(p(n)) &= -n(E_z + u_xB_y), \\
        \partial_t B_y + \partial_z E_x &= 0, \\
        \lambda^2 \partial_t E_x + \partial_z B_y &= nu_x, \\
        \lambda^2 \partial_t E_z &= nu_z, \\
        \lambda^2 \partial_z E_z &= 1 - n,
    \end{align*}
\end{minipage}
$\xrightarrow[]{\lambda \rightarrow 0}$
\begin{minipage}{0.3\textwidth}
    \begin{align*}
        n &= 1,\\
        \varepsilon^2 \partial_t(u_x) &= - E_x, \\
        E_z + u_xB_y &= 0, \\
        u_z &= 0, \\
        \partial_t B_y + \partial_z E_x &= 0, \\
        \partial_z B_y &= nu_x,
    \end{align*}
\end{minipage}
where the subscript indicates the direction of the component. An isentropic process with the equation of state $p(n) = n^\gamma$ is assumed. 

\subsubsection{1D Fully-discrete Plasma Model} \label{sec:1d_fully_discrete_model}
The fully-discrete scheme proposed in \cite{degond_2012} is given below. From now on, the superscript of variables involving $m$ indicates the time step. The scheme is built on a uniform 1D mesh with cell size $h$ and evolves the system with time step $\delta^m := t^{m+1} - t^m$:  
\begin{align*}
    \frac{n^{m+1}_k - n^m_k}{\delta^m} + \frac{\mycolorbox{orange!30}{f^{n,m+1/2}_{k+1/2} - f^{n,m+1/2}_{k-1/2}}}{h} &= 0, \\
    \frac{(nu_x)^{m+1}_k - (nu_x)^m_k}{\delta^m} + \frac{f^{u_x,m}_{k+1/2} - f^{u_x,m}_{k-1/2}}{h} &= -\frac{n^m_k \mycolorbox{orange!30}{E^{m+1}_{x,k}}}{\varepsilon^2} + \frac{n^m_k u^m_{z,k}\Tilde{B}^m_{y,k}}{\varepsilon^2},\\
    \frac{(nu_z)^{m+1}_k - (nu_z)^m_k}{\delta^m} + \frac{f^{u_z,m}_{k+1/2} - f^{u_z,m}_{k-1/2}}{h} &= - \frac{n^m_k \mycolorbox{orange!30}{\Tilde{E}^{m+1}_{z,k}}}{\varepsilon^2} - \frac{n^m_k u^m_{x,k}\Tilde{B}^m_{y,k}}{\varepsilon^2}, \\ 
    \frac{B^{m+1}_{y,k+1/2} - B^{m}_{y,k+1/2}}{\delta^m} + \frac{\mycolorbox{orange!30}{E^{m+1}_{x,k+1} - E^{m+1}_{x,k}}}{h} &= 0, \\
    \lambda^2 \frac{E^{m+1}_{x,k} - E^{m}_{x,k}}{\delta^m} + \frac{\mycolorbox{orange!30}{B^{m+1}_{y,k+1/2} - B^{m+1}_{y,k-1/2}}}{h} &= \mycolorbox{orange!30}{(nu_x)^{m+1}_k}, \\
    \lambda^2 \frac{E^{m+1}_{z,k+1/2} - E^{m}_{z,k+1/2}}{\delta^m} &= \mycolorbox{orange!30}{f^{m+1}_{n,k+1/2}}, 
\end{align*}
where 
\begin{equation*}
    \Tilde{E}^m_{z,k} = \frac{1}{2}(E^m_{z,k+1/2} + E^m_{z,k-1/2}), \ \ \ \Tilde{B}^m_{y,k} = \frac{1}{2}(B^m_{y,k+1/2} + B^m_{y,k-1/2}),
\end{equation*}
are the averaged electromagnetic fields, and the fluxes read
\begin{align*}
    f^{n,m+1/2}_{k+1/2} & = \frac{1}{2}[\mycolorbox{orange!30}{(nu_z)^{m+1}_k + (nu_z)^{m+1}_{k+1}} + \mu^m_{k+1/2}(n^m_k - n^m_{k+1})], \\
    f^{u_x,m}_{k+1/2} & = \frac{1}{2}[(nu_zu_x)^{m}_k + (nu_zu_x)^{m}_{k+1} + \mu^m_{k+1/2}((nu_x)^m_k - (nu_x)^m_{k+1})], \\
    f^{u_z,m}_{k+1/2} & = \frac{1}{2}[(nu_z^2 + p(n)/\varepsilon^2)^{m}_k + (nu_z^2 + p(n)/\varepsilon^2)^{m}_{k+1} + \mu^m_{k+1/2}((nu_z)^m_k - (nu_z)^m_{k+1})].
\end{align*}
The implicit terms are highlighted and are all essential to achieve the AP property. The implicitness of the electric field in the Lorentz force is shown to be necessary in \cite{fabre_1992} for the Euler-Poisson system. In \cite{degond_2012}, based on the linearized stability analysis, the author shows that the full-implicit treatment of the Maxwell equations is essential to the stability in the quasi-neutral limit. Besides, the mass flux in the mass conservation equation and the current in Amp\`{e}re's law has the same level of implicitness to guarantee consistency with Gauss's law.  

\subsection{Semi-implicit Fully-discrete AP Scheme in 3D} \label{sec:3d_ap_scheme}
Combining the 3D FIT-FVM framework presented in Section \ref{sec:spatial_discretization} and the time-stepping scheme shown below, we propose the following semi-implicit fully-discrete AP scheme in 3D:
\begin{subequations}
\begin{align}
    \left[\delta_m^{-1} (\mathbf{b}^{m+1} - \mathbf{b}^{m}) + \mathbb{C}\mycolorbox{orange!30}{\mathbf{e}^{m+1}} = \mathbf{0} \right]_i,\ \ &\forall i:A_i \subset \Omega, \label{equ:maxwell_faraday_ap}\\
    \left[\lambda^2\delta_m^{-1}(\mathbf{d}^{m+1} - \mathbf{d}^m)- \Tilde{\mathbb{C}}\mycolorbox{orange!30}{\mathbf{h}^{m+1}} = - \Sigma_\ast q_\ast \mycolorbox{orange!30}{\bm{f}^{n,m+1}_{\ast}}\right]_i,\ \ &\forall i:\Tilde{A}_i\subset\Omega_P, \label{equ:maxwell_ampere_plasma_ap}\\
    \left[\lambda^2\delta_m^{-1}(\mathbf{d}^{m+1} - \mathbf{d}^m)- \Tilde{\mathbb{C}}\mycolorbox{orange!30}{\mathbf{h}^{m+1}} + \mathbb{H}\mathbb{G}\mycolorbox{orange!30}{\bm{\psi}^{m+1}} = \mathbf{0} \right]_i,\ \ &\forall i:\Tilde{A}_i\subset\Omega_N, \label{equ:maxwell_ampere_nonconducting_ap}\\
    \left[\mathbb{D}\mycolorbox{orange!30}{\mathbf{d}^{m+1}} = \mathbf{0}\right]_i, \ \ &\forall i : \Tilde{V}_i \subset \Omega_N, \label{equ:gauss_nonconducting_ap} \\
    \left[\delta_m^{-1}(\mathbf{U}_{*}^{m+1} - \mathbf{U}_{*}^{m}) + \mathbb{\Tilde{V}}^{-1}\mathbb{\Tilde{D}}\mathbb{\Tilde{A}}\mycolorbox{orange!30}{\mathbf{F}_\ast^{m+1/2}} = \mycolorbox{orange!30}{\mathbf{RHS}_\ast^{m+1/2}} \right]_i,\ \ &\forall i : \Tilde{V}_i \subset \Omega_P, \label{equ:euler_ap}
\end{align}
where 
\begin{align}
    \mathbf{U}_{*,i}^{m} &=
    \begin{pmatrix}
    n \\
    n \mathbf{u} \\
    n e
    \end{pmatrix}^m_{\ast,i}, \\
    \mathbf{F}_{*,i}^{m+1/2} &=
    \begin{pmatrix}
    f^{n,m+1} \\
    \bm{f}^{u,m} \\
    f^{e,m}
    \end{pmatrix}_{\ast,i}
    = 
    \begin{pmatrix}
    \frac{1}{2}\left[\mycolorbox{orange!30}{(nu_{\bot})_{L}^{m+1}} + \mycolorbox{orange!30}{(nu_{\bot})_{R}^{m+1}}\right] - \frac{1}{2}s^m(n_{R}^m - n_{L}^m) \\
    \frac{1}{2}\left[(nu_{\bot}\mathbf{u})^m_{L} + (nu_{\bot}\mathbf{u})^m_{R} + p_{L}^m\mathbf{n}_j + p_{R}^m\mathbf{n}_j\right] - \frac{1}{2}s^m\left[(n\mathbf{u})^m_{R} - (n\mathbf{u})^m_{L}\right] \\
    \frac{1}{2}\left[(nhu_\bot)^m_{L} + (nhu_\bot)^m_{R}\right] - \frac{1}{2}s^m\left[(ne)^m_{R} - (ne)^m_{L}\right]
    \end{pmatrix}_{\ast,i}, \label{equ:flux_ap}\\
    \mathbf{RHS}_{*,i}^{m+1/2} &=
    \begin{pmatrix}
    0 \\
    \varepsilon_*^{-2}q_*\left[n_*^m\mycolorbox{orange!30}{\mathbf{E}^{m+1}} + (n\mathbf{u})^m_*\times\mathbf{B}^m\right] \\
    \varepsilon_*^{-2}q_*(n\mathbf{u})^m_* \cdot \mycolorbox{orange!30}{\mathbf{E}^{m+1}}
    \end{pmatrix}_i +
    \begin{pmatrix}
    0 \\
    \varepsilon_*^{-2}\mycolorbox{orange!30}{\mathbf{R}_{*}^{\text{coll},m+1}} \\
    \varepsilon_*^{-2}\mycolorbox{orange!30}{Q_*^{\text{coll}, m+1}} 
    \end{pmatrix}_i, \label{equ:rhs_ap}\\
    \mathbf{E}^{m+1} &= \Tilde{\mathbb{R}}_E\mathbf{d}^{m+1},
    \ \ \ \ 
    \mathbf{B}^{m} = \Tilde{\mathbb{R}}_B\mathbf{b}^{m}, \\
    \mathbf{R}_{*,i}^{\text{coll},m+1} &= 
    \begin{cases}
    \alpha^\text{coll}\left[n_{\text{electron}}^m\mycolorbox{orange!30}{(n\mathbf{u})^{m+1}_{\text{ion}}} - n_{\text{ion}}^m\mycolorbox{orange!30}{(n\mathbf{u})^{m+1}_{\text{electron}}}\right]_i, \text{   if   } * = \text{electron} \\
    \alpha^\text{coll}\left[n_{\text{ion}}^m\mycolorbox{orange!30}{(n\mathbf{u})^{m+1}_{\text{electron}}} - n_{\text{electron}}^m\mycolorbox{orange!30}{(n\mathbf{u})^{m+1}_{\text{ion}}}\right]_i, \text{   if   } * = \text{ion}
    \end{cases}  \label{equ:R_coll_ap}\\
    Q_{*,i}^{\text{coll},m+1} &= \mycolorbox{orange!30}{\mathbf{R}_{*,i}^{\text{coll},m+1} \cdot \mathbf{u}_{\ast,i}^{m+1}} \label{equ:Q_coll_ap}
.\end{align}
\end{subequations}
The quantities with superscript $m+1/2$ indicate their dependency on the quantities at both $m$-th and $(m+1)$-th iterations. In Rusanov flux (\ref{equ:flux_ap}), we denote by $u_\perp$ the normal component velocity with respect to the dual face $\Tilde{A}_j$. We restrain the illustration of the collision term (\ref{equ:R_coll_ap}) (\ref{equ:Q_coll_ap}) to the two-species case for the sake of simplicity. 

The time-stepping scheme mimics the 1D scheme shown in the previous section. The implicitness of the friction term is owing to the stiffness incurred from a potentially large value of the prefactor $\varepsilon^{-2}_*\alpha^\text{coll}$.

\subsubsection{Inappropriate Boundary Condition} \label{sec:inapp_bc}
We would like to point out that the boundary condition (\ref{equ:bc_zero_curl_h}) is not valid in the quasi-neutral limit, which is revealed by taking the limit of Amp\`{e}re's law in the non-conducting region (\ref{equ:maxwell_ampere_nonconducting_ap}). Since $\bm{\psi}^{m+1}$ can be shown to be zero by multiplying (\ref{equ:gauss_nonconducting_ap}) by $\mathbb{D}$, we obtain that
\begin{equation*}
    [\Tilde{\mathbb{C}}\mathbf{h}^{m+1} = 0]_i, \ \ \forall i : \Tilde{A}_i \subset \Omega_N,
\end{equation*}
which makes the boundary condition (\ref{equ:bc_zero_curl_h}) an over-determined condition. We propose to replace (\ref{equ:bc_zero_curl_h}) by 
\begin{equation*}
    [\mathbf{d}^{m+1} = 0]_i, \ \ \forall i : \Tilde{A}_i \subset \Omega_N.
\end{equation*}
One can easily check its equivalence to (\ref{equ:bc_zero_curl_h}) when $\lambda = \mathcal{O}(1)$. In fact, without this condition the Maxwell system in the non-conducting region is not well-posed when $\lambda = 0$ \cite{alfredo_2003}. 

\subsubsection{CFL Condition}
It has been shown in \cite{degond_2012} that the stability-induced constraint on the time-step size does not depend on the value of $\lambda$ thanks to the implicitness in the discrete Maxwell system. However, the Euler system is discretized by an explicit scheme and thus is still subject to a CFL condition.

In our case, we have a conservation law with source terms. Let us consider the model equation
\begin{equation*}
    \partial_tu + c\partial_xu = \beta u, 
\end{equation*}
where $c>0$ and $\beta<0$ are constant. By a first-order upwind scheme
\begin{equation*}
    \delta_t^{-1}(u^{m+1}_k - u^m_k) + c\delta_x^{-1}(u^m_k - u^m_{k-1}) = \beta u^m_k,
\end{equation*}
we can perform Neumann analysis and deduce the CFL condition
\begin{equation*}
    \delta_t \leq \left[\frac{c}{\delta_x} + \frac{\beta}{2}\right]^{-1}.
\end{equation*}
On noticing the source term $\varepsilon_*^{-2}q_*(n\mathbf{u})^m_*\times\mathbf{B}^m$ in the momentum equation, we heuristically take the following restriction
\begin{equation*}
    \delta_t^m \leq \min_*\bigg\{\left[\frac{s^m_*}{\delta_x} + \frac{\varepsilon^{-2}_*|q_*||\mathbf{B}^m|}{2}\right]^{-1}\bigg\},
\end{equation*}
which is proved to be necessary by numerical experiments.

\subsubsection{Procedure of Time-stepping}
The semi-implicit scheme (\ref{equ:maxwell_faraday_ap})-(\ref{equ:Q_coll_ap}) entails solving a linear system for each time step. We would like to provide a brief guide on how to build such a linear system and evolve the system. 

The main step is to establish the connection between the mass fluxes $\mathbf{f}^{n,m+1}_*$ and discrete electric induction $\mathbf{d}$. From the momentum conservative equation, one can get the relation between the momenta $n\mathbf{u}^{m+1}_*$ and the reconstructed electric field $\mathbf{E}^{m+1}$. Given the reconstruction relation (\ref{equ:reconstruction}), we can get the following relation
\begin{equation*}
    (n\mathbf{u})_*^{m+1} = \hat{\mathbb{M}}^m_* \mathbf{d}^{m+1} + \bm{\eta}_*^m. 
\end{equation*}
Next, by the formula for the mass fluxes in (\ref{equ:flux_ap}), the expression for the currents in $\Omega_P$ (see (\ref{equ:maxwell_ampere_plasma_ap})) is written by 
\begin{equation} \label{equ:discrete_ohm}
    \mathbf{j}^{m+1} := \Sigma_\ast q_\ast \bm{f}^{n,m+1}_\ast = \mathbb{M}_\sigma^{m} \mathbf{d}^{m+1} + \mathbf{j}^m_{\text{aux}}.
\end{equation}
The calculation of $\hat{\mathbb{M}}_*^m, \bm{\eta}_*^m, \mathbb{M}_\sigma^m, \mathbf{j}^m_{\text{aux}}$ is slightly lengthy but straightforward, so we omit the details. 

The discrete Maxwell system (\ref{equ:maxwell_faraday_ap})-(\ref{equ:gauss_nonconducting_ap}) is closed provided (\ref{equ:discrete_ohm}) and can be evolved by solving a linear system. The Euler system (\ref{equ:euler_ap}) afterward evolves explicitly. 

\begin{remark}
    The formula (\ref{equ:discrete_ohm}) functions as Ohm's law in the discrete level and $\mathbb{M}_\sigma^m$ can be treated as a "conductivity" matrix. Since in the quasi-neutral limit $\lambda \rightarrow 0$ we lose control of the $\mathbf{E}$-field through its time derivative, $\mathbb{M}_\sigma^m$ is crucial to the stability of the scheme. Since $\mathbf{j}$ and $\mathbf{d}$ are both defined on dual faces, it is reasonable to adopt a local relation between them. Therefore, we perform the \emph{diagonal lumping} trick on (\ref{equ:discrete_ohm}), i.e. rendering it diagonal by accumulating the row sum. We observe enhanced stability in the numerical experiments with very minor changes in the results.
\end{remark}
\section{Numerical Experiment}

We conduct numerical experiments based on the geometric setting and boundary conditions as presented in Section \ref{sec:BC}. The primal-dual mesh pair $(\mathcal{M}, \mathcal{M}')$ is generated based on the code developed in \cite[][ch. 1]{fuchs_2021}. An instance is shown in Fig. \ref{fig:primal_dual_meshes}. We consider a two-fluid plasma model which is composed of electrons and ions. We set the mass ratio $\varepsilon_e := m_e / m_i = 10^4$ and the collision parameter $\alpha^\text{coll} = 32$.
\begin{figure}
    \centering
    \includegraphics[scale=0.3]{primal_mesh.png}
    \hspace{1cm}
    \includegraphics[scale=0.3]{dual_mesh.png}
    \caption{Primal mesh (left) and dual mesh (right).}
    \label{fig:primal_dual_meshes}
\end{figure}
\subsection{Case 1: Quasi-1D Problem}
On noticing the radial symmetry of the domain as well as boundary conditions, we can simplify the governing equations defined at the axis of symmetry, i.e. $z$-axis in this case, thanks to vanishing radial components of the vector fields and their radial derivatives. The Euler-Maxwell system at the axis of symmetry reduces to
\begin{align*}
    &\partial_t n_* + \partial_z(n_*u_{*,z}) = 0, \\
    &\partial_t (n_* u_{*,z}) + \partial_z(n_*u_{*,z}^2) + \varepsilon_*^{-2} \partial_z p_* = \varepsilon_*^{-2}q_*n_*E_z, \\
    &\partial_t (n_*e_*) + \partial_z (n_* h_* u_{*,z}) = \varepsilon_*^{-2} q_* n_* u_{*,z} E_z, \\
    \lambda^2 &\partial_t E_z = \sum_* - q_* n_* u_{*,z}.
\end{align*}
which is similar to the 1D model in Section \ref{sec:projection_to_1d}. Therefore, it is reasonable to compare the results produced by the 1D scheme in Section \ref{sec:1d_fully_discrete_model} and the one on $z$-axis produced by the 3D scheme proposed in Section \ref{sec:3d_ap_scheme}. Fig. \ref{fig:z_axis_reduction} demonstrates good matching. 
\begin{figure}
    \centering
    \includegraphics{z_axis_reduction.eps}
    \caption{Comparison of 1D two-fluid model and reduced 1D model on $z$-axis from 3D two-fluid model. The results are both generated on meshes with 64 cells along the $z$-axis. No friction term exists. $t = 5 \times 10^{-4}.$}
    \label{fig:z_axis_reduction}
\end{figure}

\subsection{Case 2: 3D Cylindrical Problem}

We stick to the setting in Section \ref{sec:BC} and use the following initial conditions
\begin{equation*}
    n_\ast(\mathbf{x}, 0) = 1, \ \ \  p_\ast(\mathbf{x},0) = 1, \ \ \forall \mathbf{x}\in\Omega, \ast \in \{\text{electron}, \text{ion}\}.
\end{equation*}
All the other quantities are set to zero initially. We set $\varphi(\mathbf{x}, t)|_{\Gamma_C^-} = 0, \varphi(\mathbf{x}, t)|_{\Gamma_C^+} = 1$, that is, a constant voltage is applied at the anode and excites the system. 

The cylindrical domain is 5.0 in length and 1.5 in radius. The plasma domain $\Omega_P$ is 1.0 in radius, i.e. the non-conducting domain $\Omega_N$ has an inner radius of 1.0 and an outer radius of 1.5. 

\begin{remark}
    Such an initial state is compatible with the BCs and the quasi-neutral condition $\rho = 0$, which means no initial layer and boundary layer in the sense of perturbation theory will arise when $\lambda \rightarrow 0$. 
\end{remark}

In Fig. \ref{fig:3d_vec_field_E_B_ue}, the numerical solutions for $\lambda = 1.0, 0.1$ and $0$ are shown to visualize the 3D structure of the electromagnetic field. Qualitative verification can be done in many aspects. First, the rotational symmetry of the problem is preserved. Second, the $\mathbf{E}$-field points from $\Gamma^+_C$ to $\Gamma^-_C$ with a relatively uniform value of approximately 0.2 ($=\text{applied voltage}/\text{cylinder length}$) as a consequence of the curl-free property of the $\mathbf{E}$-field in the steady state according to Faraday's law. This is also confirmed in Fig. \ref{fig:zaxis-data_vs_z-T_10}. Note that it does not hold for $\lambda = 1$ since the system has a large characteristic time and takes a long time to reach an equilibrium, which will be shown later in Fig. \ref{fig:origin-data_vs_time}. Besides, the $\mathbf{B}$-field is spiral-shaped and orthogonal to the $\mathbf{E}$-field. Also, under the driven force by the $\mathbf{E}$-field, the electrons move towards the anode $\Gamma^+_C$ as expected.
\begin{figure}
    \centering
    \begin{subfigure}[b]{\textwidth}
        \hspace{-1cm}
        \begin{tikzpicture}
        \draw[blue, -to] (0,0) -- (20:0.7) node[right]{\small $z$};
        \draw[blue, -to] (0,0) -- (0,0.7) node[above]{\small $x$};
        \draw[blue, -to] (0,0) -- (0.7,0) node[below]{\small $y$};
        \end{tikzpicture}
        \includegraphics[scale=0.25]{E-field_lambda-1.png}
        \includegraphics[scale=0.25]{B-field_lambda-1.png}
        \includegraphics[scale=0.25]{electronVel_lambda-1.png}
        \caption{$\lambda = 1.0$}
    \end{subfigure}
     \begin{subfigure}[b]{\textwidth}
        \hspace{-1cm}
        \begin{tikzpicture}
        \draw[blue, -to] (0,0) -- (20:0.7) node[right]{\small $z$};
        \draw[blue, -to] (0,0) -- (0,0.7) node[above]{\small $x$};
        \draw[blue, -to] (0,0) -- (0.7,0) node[below]{\small $y$};
        \end{tikzpicture}
        \includegraphics[scale=0.25]{E-field_lambda-1e-1.png}
        \hspace{0.3cm}
        \includegraphics[scale=0.25]{B-field_lambda-1e-1.png}
        \includegraphics[scale=0.25]{electronVel_lambda-1e-1.png}
        \caption{$\lambda = 1.0$}
    \end{subfigure}
    \begin{subfigure}[b]{\textwidth}
        \hspace{-1cm}
        \begin{tikzpicture}
        \draw[blue, -to] (0,0) -- (20:0.7) node[right]{\small $z$};
        \draw[blue, -to] (0,0) -- (0,0.7) node[above]{\small $x$};
        \draw[blue, -to] (0,0) -- (0.7,0) node[below]{\small $y$};
        \end{tikzpicture}
        \includegraphics[scale=0.25]{E-field_lambda-0.png}
        \hspace{0.3cm}
        \includegraphics[scale=0.25]{B-field_lambda-0.png}
        \includegraphics[scale=0.25]{electronVel_lambda-0.png}
        \caption{$\lambda = 1.0$}
    \end{subfigure}
    \caption{Snapshots of the $\mathbf{E}$-field, $\mathbf{B}$-field, and $\mathbf{u}_e$ for different $\lambda$ at $t = 10$ based on a primal mesh with 1920 cells (16 cells along $z$-axis). } 
    \label{fig:3d_vec_field_E_B_ue}
\end{figure}

Next, we perform a grid study. The norms of the solutions under mesh refinement are shown in Fig. \ref{fig:grid_study_3d}. Due to the high computational cost in 3D simulations, reference solutions produced by a highly-refined mesh are not trivially accessible. That is why we demonstrate results generated by relatively coarse meshes. Fig. \ref{fig:grid_study_3d} indicates that the solutions are stable under mesh refinement. To reveal more features of the solutions, in Fig. \ref{fig:grid_study_3d_clip_lambda-1e-1} and \ref{fig:grid_study_3d_clip_lambda-0}, we plot some quantities at the cross-section generated by meshes of different sizes for $\lambda = 0.1$ and $0$. Qualitatively the same solutions are produced under different meshes.

\begin{figure}
    \centering
    \includegraphics[scale=0.8]{norm-vs-mesh.eps}
    \caption{1-norms of quantities with respect to different mesh sizes: The results are computed for $\lambda = 1$ and $0.1$ at $t = 1$.}.
    \label{fig:grid_study_3d}
\end{figure}

\begin{figure}
    \centering
    \textit{\textsf{Refinement 1\hspace{2.5cm}Refinement 2\hspace{2.5cm}Refinement 3\hspace{1cm}}}
    
    \includegraphics[scale=0.27]{clip_E_T-1_lambda-1e-1_8-2-2.png}
    \includegraphics[scale=0.27]{clip_E_T-1_lambda-1e-1_16-3-3.png}
    \includegraphics[scale=0.27]{clip_E_T-1_lambda-1e-1_32-3-4.png}
    \includegraphics[scale=0.27]{clip_B_T-1_lambda-1e-1_8-2-2.png}
    \includegraphics[scale=0.27]{clip_B_T-1_lambda-1e-1_16-3-3.png}
    \includegraphics[scale=0.27]{clip_B_T-1_lambda-1e-1_32-3-4.png}
    \includegraphics[scale=0.27]{clip_ne_T-1_lambda-1e-1_8-2-2.png}
    \includegraphics[scale=0.27]{clip_ne_T-1_lambda-1e-1_16-3-3.png}
    \includegraphics[scale=0.27]{clip_ne_T-1_lambda-1e-1_32-3-4.png}
    \includegraphics[scale=0.27]{clip_ni_T-1_lambda-1e-1_8-2-2.png}
    \includegraphics[scale=0.27]{clip_ni_T-1_lambda-1e-1_16-3-3.png}
    \includegraphics[scale=0.27]{clip_ni_T-1_lambda-1e-1_32-3-4.png}
    \caption{Quantities at the cross-section generated by meshes with different refinement levels: 1920 primal cells in Refinement 1; 14592 primal cells in Refinement 2; 30720 primal cells in refinement 3. The snapshots are computed for $\lambda = 0.1$ at $t = 1$.}
    \label{fig:grid_study_3d_clip_lambda-1e-1}
\end{figure}

\begin{figure}
    \centering
    \textit{\textsf{Refinement 1\hspace{2.5cm}Refinement 2\hspace{2.5cm}Refinement 3\hspace{1cm}}}
    
    \includegraphics[scale=0.27]{slice_E_T-1_lambda-0_8-2-2.png}
    \includegraphics[scale=0.27]{slice_E_T-1_lambda-0_16-3-3.png}
    \includegraphics[scale=0.27]{slice_E_T-1_lambda-0_32-3-4.png}
    \includegraphics[scale=0.27]{slice_B_T-1_lambda-0_8-2-2.png}
    \includegraphics[scale=0.27]{slice_B_T-1_lambda-0_16-3-3.png}
    \includegraphics[scale=0.27]{slice_B_T-1_lambda-0_32-3-4.png}
    \includegraphics[scale=0.27]{slice_ne_T-1_lambda-0_8-2-2.png}
    \includegraphics[scale=0.27]{slice_ne_T-1_lambda-0_16-3-3.png}
    \includegraphics[scale=0.27]{slice_ne_T-1_lambda-0_32-3-4.png}
    \includegraphics[scale=0.27]{slice_ni_T-1_lambda-0_8-2-2.png}
    \includegraphics[scale=0.27]{slice_ni_T-1_lambda-0_16-3-3.png}
    \includegraphics[scale=0.27]{slice_ni_T-1_lambda-0_32-3-4.png}
    \caption{Quantities at the cross-section generated by meshes with different refinement levels. Refinement 1: 1920 primal cells; Refinement 2: 14592 primal cells; Refinement 3: 30720 primal cells. The snapshots are computed for $\lambda = 0$ at $t = 1$.}
    \label{fig:grid_study_3d_clip_lambda-0}
\end{figure}

To inspect how the system evolves, the time histories of some quantities are displayed in Fig. \ref{fig:origin-data_vs_time}. Being originally at rest, the system is excited by the applied voltage and generates oscillations that dampen over time. A larger value of $\lambda$ leads to oscillations with larger amplitude and slower damping whereas with a smaller $\lambda$ the system quickly reaches a steady state. It is consistent with the fact that $\lambda$ characterizes the time scale of the electromagnetic field. From a different perspective, it is a reflection of the shielding effect of plasma which is characterized by the Debye length. Besides, the electrons move much faster and oscillate more than ions as a consequence of the large difference in inertia. Furthermore, the structure-preserving property of our scheme is revealed by the exact balance of the currents at $\Gamma^+_C$ and $\Gamma^-_C$ \cite{Hiptmair_2021}, as is shown in the last figure in Fig. \ref{fig:origin-data_vs_time}.

\begin{figure}
    \centering
    \includegraphics[scale=0.9]{data-vs-time_stepVoltage.eps}
    \caption{Time histories of quantities at the domain center and of the averaged current densities at $\Gamma^+_C$ (anode) and $\Gamma^-_C$ (cathode) for different values of $\lambda$. The simulations are done on a mesh with 1920 primal cells with 8 layers along the $z$-axis.}
    \label{fig:origin-data_vs_time}
\end{figure}

The stabilization proposed in Section \ref{sec:reform_discrete} is essential to achieve a stable result when $\lambda$ tends to zero. As is shown in Fig. \ref{fig:stabilization_comparison}, the scheme without stabilization tends to blow up when $\lambda$ is close to zero while the one with stabilization remains stable. 
\begin{figure}
    \centering
    \includegraphics{stabilizationComparision_stepVoltage.eps}
    \caption{Stabilization in the non-conducting domain $\Omega_N$. The $\mathbf{E}$-field z-component in a boundary cell in $\Omega_N$ is displayed over time. }
    \label{fig:stabilization_comparison}
\end{figure}

The capability of our approach to addressing the non-neutral ($\lambda = \mathcal{O}(1)$) and quasi-neutral ($\lambda = 0$) regimes has been demonstrated in the aforementioned results in the sense that it is stable under different values of $\lambda$. Another important check goes to the quasi-neutral condition, i.e. $\rho = 0$ (\ref{equ:maxwell_gauss_D_limit}) when $\lambda = 0$. We display the $\mathbf{E}$-field and particle densities on the $z$-axis in Fig. \ref{fig:zaxis-data_vs_z-T_10}. The lower figure demonstrates the matching of the density profiles of the electrons and ions, namely, the quasi-neutrality holds in the discrete level.

\begin{figure}
    \centering
    \includegraphics{data-vs-z_stepVoltage.eps}
    \caption{Quantities along $z$-axis for different $\lambda$: The results are computed at $t = 10$ on a mesh with 1920 primal cells with 8 layers along $z$-axis.}.
    \label{fig:zaxis-data_vs_z-T_10}
\end{figure}


\section{Conclusion}

\bibliography{ref}
\end{document}